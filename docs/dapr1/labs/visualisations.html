<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 13 Visualisations | PPLS PhD Training Workshop: Statistics and R</title>
  <meta name="description" content="This is the main page of the course and contains a course overview, schedule and learning outcomes.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 13 Visualisations | PPLS PhD Training Workshop: Statistics and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the main page of the course and contains a course overview, schedule and learning outcomes." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Visualisations | PPLS PhD Training Workshop: Statistics and R" />
  
  <meta name="twitter:description" content="This is the main page of the course and contains a course overview, schedule and learning outcomes." />
  

<meta name="author" content="Anastasia Ushakova and Emma Waterston">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="summary-statistics.html">
<link rel="next" href="diy.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PPLS Summer Training (R and Stats)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview of the Course</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#programme"><i class="fa fa-check"></i>Programme</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#learning-outcomes"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#preparation"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#data-sets"><i class="fa fa-check"></i>Data sets</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#expectations"><i class="fa fa-check"></i>Expectations</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lets-stay-in-touch"><i class="fa fa-check"></i>Lets stay in touch</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#list-of-extra-resources"><i class="fa fa-check"></i>List of extra resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authorship"><i class="fa fa-check"></i>Authorship</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#last-but-not-least"><i class="fa fa-check"></i>Last, but not least</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html"><i class="fa fa-check"></i><b>1</b> Getting Started in RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#r-as-an-interactive-envrionment"><i class="fa fa-check"></i><b>1.1</b> R as an interactive envrionment</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#setting-up-your-working-directory"><i class="fa fa-check"></i><b>1.2</b> Setting Up Your Working Directory</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-console.html"><a href="the-console.html"><i class="fa fa-check"></i><b>2</b> The Console</a><ul>
<li class="chapter" data-level="2.1" data-path="the-console.html"><a href="the-console.html#spacing"><i class="fa fa-check"></i><b>2.1</b> Spacing</a></li>
<li class="chapter" data-level="2.2" data-path="the-console.html"><a href="the-console.html#typos"><i class="fa fa-check"></i><b>2.2</b> Typos</a></li>
<li class="chapter" data-level="2.3" data-path="the-console.html"><a href="the-console.html#unfinishe.-d"><i class="fa fa-check"></i><b>2.3</b> Unfinishe…. d</a></li>
<li class="chapter" data-level="2.4" data-path="the-console.html"><a href="the-console.html#basic-arithmetic"><i class="fa fa-check"></i><b>2.4</b> Basic Arithmetic</a></li>
<li class="chapter" data-level="2.5" data-path="the-console.html"><a href="the-console.html#using-functions-for-calculations"><i class="fa fa-check"></i><b>2.5</b> Using Functions for Calculations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-scripts.html"><a href="r-scripts.html"><i class="fa fa-check"></i><b>3</b> R Scripts</a><ul>
<li class="chapter" data-level="3.1" data-path="r-scripts.html"><a href="r-scripts.html#short-example"><i class="fa fa-check"></i><b>3.1</b> Short Example</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="naming-variables.html"><a href="naming-variables.html"><i class="fa fa-check"></i><b>4</b> Naming variables</a></li>
<li class="chapter" data-level="5" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>5</b> Vectors</a><ul>
<li class="chapter" data-level="5.1" data-path="vectors.html"><a href="vectors.html#numeric-data"><i class="fa fa-check"></i><b>5.1</b> Numeric Data</a></li>
<li class="chapter" data-level="5.2" data-path="vectors.html"><a href="vectors.html#textcharacter-data"><i class="fa fa-check"></i><b>5.2</b> Text/Character Data</a></li>
<li class="chapter" data-level="5.3" data-path="vectors.html"><a href="vectors.html#logical-data"><i class="fa fa-check"></i><b>5.3</b> Logical Data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="vectors.html"><a href="vectors.html#exercise"><i class="fa fa-check"></i><b>5.3.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="variable-classes.html"><a href="variable-classes.html"><i class="fa fa-check"></i><b>6</b> Variable Classes</a><ul>
<li class="chapter" data-level="6.1" data-path="variable-classes.html"><a href="variable-classes.html#factors"><i class="fa fa-check"></i><b>6.1</b> Factors</a><ul>
<li class="chapter" data-level="6.1.1" data-path="variable-classes.html"><a href="variable-classes.html#exercise-1"><i class="fa fa-check"></i><b>6.1.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lists.html"><a href="lists.html"><i class="fa fa-check"></i><b>7</b> Lists</a></li>
<li class="chapter" data-level="8" data-path="matrices.html"><a href="matrices.html"><i class="fa fa-check"></i><b>8</b> Matrices</a></li>
<li class="chapter" data-level="9" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>9</b> Data Frames</a></li>
<li class="chapter" data-level="10" data-path="loading-data.html"><a href="loading-data.html"><i class="fa fa-check"></i><b>10</b> Loading Data</a><ul>
<li class="chapter" data-level="10.1" data-path="loading-data.html"><a href="loading-data.html#practical-example"><i class="fa fa-check"></i><b>10.1</b> Practical Example</a></li>
<li class="chapter" data-level="10.2" data-path="loading-data.html"><a href="loading-data.html#subsetting-dataframes"><i class="fa fa-check"></i><b>10.2</b> Subsetting Dataframes</a><ul>
<li class="chapter" data-level="10.2.1" data-path="loading-data.html"><a href="loading-data.html#replacing-values-nas"><i class="fa fa-check"></i><b>10.2.1</b> Replacing Values &amp; NAs</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="loading-data.html"><a href="loading-data.html#indexing-data-frames"><i class="fa fa-check"></i><b>10.3</b> Indexing Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>11</b> Packages</a></li>
<li class="chapter" data-level="12" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>12</b> Summary Statistics</a><ul>
<li class="chapter" data-level="12.1" data-path="summary-statistics.html"><a href="summary-statistics.html#data-cleaning"><i class="fa fa-check"></i><b>12.1</b> Data Cleaning</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="visualisations.html"><a href="visualisations.html"><i class="fa fa-check"></i><b>13</b> Visualisations</a><ul>
<li class="chapter" data-level="13.1" data-path="visualisations.html"><a href="visualisations.html#simple-plots"><i class="fa fa-check"></i><b>13.1</b> Simple Plots</a><ul>
<li class="chapter" data-level="13.1.1" data-path="visualisations.html"><a href="visualisations.html#using-plot"><i class="fa fa-check"></i><b>13.1.1</b> Using <code>plot()</code></a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="visualisations.html"><a href="visualisations.html#customising-plots"><i class="fa fa-check"></i><b>13.2</b> Customising Plots</a><ul>
<li class="chapter" data-level="13.2.1" data-path="visualisations.html"><a href="visualisations.html#labels"><i class="fa fa-check"></i><b>13.2.1</b> Labels</a></li>
<li class="chapter" data-level="13.2.2" data-path="visualisations.html"><a href="visualisations.html#plot-type"><i class="fa fa-check"></i><b>13.2.2</b> Plot Type</a></li>
<li class="chapter" data-level="13.2.3" data-path="visualisations.html"><a href="visualisations.html#other-customisable-features"><i class="fa fa-check"></i><b>13.2.3</b> Other Customisable Features</a></li>
<li class="chapter" data-level="13.2.4" data-path="visualisations.html"><a href="visualisations.html#change-axes"><i class="fa fa-check"></i><b>13.2.4</b> Change Axes</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="visualisations.html"><a href="visualisations.html#dont-panic"><i class="fa fa-check"></i><b>13.3</b> Don’t Panic!</a></li>
<li class="chapter" data-level="13.4" data-path="visualisations.html"><a href="visualisations.html#other-simple-plots"><i class="fa fa-check"></i><b>13.4</b> Other Simple Plots</a><ul>
<li class="chapter" data-level="13.4.1" data-path="visualisations.html"><a href="visualisations.html#histograms"><i class="fa fa-check"></i><b>13.4.1</b> Histograms</a></li>
<li class="chapter" data-level="13.4.2" data-path="visualisations.html"><a href="visualisations.html#boxplots"><i class="fa fa-check"></i><b>13.4.2</b> Boxplots</a></li>
<li class="chapter" data-level="13.4.3" data-path="visualisations.html"><a href="visualisations.html#scatterplots"><i class="fa fa-check"></i><b>13.4.3</b> Scatterplots</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="visualisations.html"><a href="visualisations.html#how-to-save-image-files"><i class="fa fa-check"></i><b>13.5</b> How to Save Image Files</a></li>
<li class="chapter" data-level="13.6" data-path="visualisations.html"><a href="visualisations.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>13.6</b> Plotting with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="13.6.1" data-path="visualisations.html"><a href="visualisations.html#ggplot"><i class="fa fa-check"></i><b>13.6.1</b> <code>ggplot()</code></a></li>
<li class="chapter" data-level="13.6.2" data-path="visualisations.html"><a href="visualisations.html#iris-example"><i class="fa fa-check"></i><b>13.6.2</b> Iris Example</a></li>
<li class="chapter" data-level="13.6.3" data-path="visualisations.html"><a href="visualisations.html#ggplot-with-our-mydata-file"><i class="fa fa-check"></i><b>13.6.3</b> <code>ggplot()</code> with our <code>mydata</code> file</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="visualisations.html"><a href="visualisations.html#bring-it-all-together"><i class="fa fa-check"></i><b>13.7</b> Bring It All Together</a></li>
<li class="chapter" data-level="13.8" data-path="visualisations.html"><a href="visualisations.html#write-out-files"><i class="fa fa-check"></i><b>13.8</b> Write Out Files</a></li>
<li class="chapter" data-level="13.9" data-path="visualisations.html"><a href="visualisations.html#questions"><i class="fa fa-check"></i><b>13.9</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="diy.html"><a href="diy.html"><i class="fa fa-check"></i><b>14</b> DIY</a></li>
<li class="chapter" data-level="15" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html"><i class="fa fa-check"></i><b>15</b> Tests and modelling in R</a><ul>
<li class="chapter" data-level="15.1" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#hypothesis-testing"><i class="fa fa-check"></i><b>15.1</b> Hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="examining-relationships-more-than-one-variable.html"><a href="examining-relationships-more-than-one-variable.html"><i class="fa fa-check"></i><b>16</b> Examining Relationships (more than one variable)</a><ul>
<li class="chapter" data-level="16.1" data-path="examining-relationships-more-than-one-variable.html"><a href="examining-relationships-more-than-one-variable.html#t-test"><i class="fa fa-check"></i><b>16.1</b> T test</a></li>
<li class="chapter" data-level="16.2" data-path="examining-relationships-more-than-one-variable.html"><a href="examining-relationships-more-than-one-variable.html#chi-squared-distribution-and-test"><i class="fa fa-check"></i><b>16.2</b> Chi squared distribution and test</a><ul>
<li class="chapter" data-level="16.2.1" data-path="examining-relationships-more-than-one-variable.html"><a href="examining-relationships-more-than-one-variable.html#contingency-tables"><i class="fa fa-check"></i><b>16.2.1</b> Contingency tables</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="examining-relationships-more-than-one-variable.html"><a href="examining-relationships-more-than-one-variable.html#chi-squared-distribution"><i class="fa fa-check"></i><b>16.3</b> Chi squared distribution</a></li>
<li class="chapter" data-level="16.4" data-path="examining-relationships-more-than-one-variable.html"><a href="examining-relationships-more-than-one-variable.html#one-way-anova"><i class="fa fa-check"></i><b>16.4</b> One way Anova</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="correlation-causation-and-lm.html"><a href="correlation-causation-and-lm.html"><i class="fa fa-check"></i><b>17</b> Correlation, Causation, and LM</a><ul>
<li class="chapter" data-level="17.1" data-path="correlation-causation-and-lm.html"><a href="correlation-causation-and-lm.html#sharks-and-ice-cream-example"><i class="fa fa-check"></i><b>17.1</b> Sharks and ice cream example</a></li>
<li class="chapter" data-level="17.2" data-path="correlation-causation-and-lm.html"><a href="correlation-causation-and-lm.html#simple-linear-regression-in-r"><i class="fa fa-check"></i><b>17.2</b> Simple Linear Regression in R</a></li>
<li class="chapter" data-level="17.3" data-path="correlation-causation-and-lm.html"><a href="correlation-causation-and-lm.html#regression-diagnostics---assess-the-validity-of-a-model"><i class="fa fa-check"></i><b>17.3</b> Regression Diagnostics - assess the validity of a model</a><ul>
<li class="chapter" data-level="17.3.1" data-path="correlation-causation-and-lm.html"><a href="correlation-causation-and-lm.html#violations-of-the-assumptions-available-treatments"><i class="fa fa-check"></i><b>17.3.1</b> Violations of the assumptions: available treatments</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="correlation-causation-and-lm.html"><a href="correlation-causation-and-lm.html#standardisation"><i class="fa fa-check"></i><b>17.4</b> Standardisation</a></li>
<li class="chapter" data-level="17.5" data-path="correlation-causation-and-lm.html"><a href="correlation-causation-and-lm.html#interaction-simple-slope-and-multiple-explanatory-factors"><i class="fa fa-check"></i><b>17.5</b> Interaction (simple slope) and multiple explanatory factors</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="model-selection.html"><a href="model-selection.html"><i class="fa fa-check"></i><b>18</b> Model selection</a><ul>
<li class="chapter" data-level="18.1" data-path="model-selection.html"><a href="model-selection.html#aic-bic"><i class="fa fa-check"></i><b>18.1</b> AIC &amp; BIC</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="diy-1.html"><a href="diy-1.html"><i class="fa fa-check"></i><b>19</b> DIY</a></li>
<li class="chapter" data-level="20" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html"><i class="fa fa-check"></i><b>20</b> Simple Linear Model and Mixed Methods</a><ul>
<li class="chapter" data-level="20.1" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#data-sets-1"><i class="fa fa-check"></i><b>20.1</b> Data sets</a></li>
<li class="chapter" data-level="20.2" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#longitudinal-data"><i class="fa fa-check"></i><b>20.2</b> Longitudinal Data</a></li>
<li class="chapter" data-level="20.3" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#why-a-new-model"><i class="fa fa-check"></i><b>20.3</b> Why a new model?</a></li>
<li class="chapter" data-level="20.4" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#ecological-fallacy-quick-illustration---no-need-to-run"><i class="fa fa-check"></i><b>20.4</b> Ecological Fallacy (quick illustration) - no need to run</a></li>
<li class="chapter" data-level="20.5" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#simple-example"><i class="fa fa-check"></i><b>20.5</b> Simple Example</a></li>
<li class="chapter" data-level="20.6" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#now-for-advanced-model-set-up"><i class="fa fa-check"></i><b>20.6</b> Now for Advanced: Model set up</a><ul>
<li class="chapter" data-level="20.6.1" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#pooling"><i class="fa fa-check"></i><b>20.6.1</b> Pooling</a></li>
<li class="chapter" data-level="20.6.2" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#no-pooling"><i class="fa fa-check"></i><b>20.6.2</b> No pooling</a></li>
<li class="chapter" data-level="20.6.3" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#partial-pooling-varying-intercepts"><i class="fa fa-check"></i><b>20.6.3</b> Partial Pooling (varying intercepts)</a></li>
<li class="chapter" data-level="20.6.4" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#partial-pooling-extended---varying-intercepts-andor-slopes"><i class="fa fa-check"></i><b>20.6.4</b> Partial Pooling Extended - (varying intercepts and/or slopes)</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#multilevel-modelling-with-random-intercepts-and-slopes"><i class="fa fa-check"></i><b>20.7</b> Multilevel modelling with random intercepts and slopes</a><ul>
<li class="chapter" data-level="20.7.1" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#overview-of-the-data-set"><i class="fa fa-check"></i><b>20.7.1</b> Overview of the data set</a></li>
<li class="chapter" data-level="20.7.2" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#prepare"><i class="fa fa-check"></i><b>20.7.2</b> Prepare</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#random-slopes-intercepts-and-cross-level-interactions-optional"><i class="fa fa-check"></i><b>20.8</b> Random slopes, intercepts and cross level interactions (optional)</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="testing-the-assumptions.html"><a href="testing-the-assumptions.html"><i class="fa fa-check"></i><b>21</b> Testing the assumptions</a></li>
<li class="chapter" data-level="22" data-path="coffee-break.html"><a href="coffee-break.html"><i class="fa fa-check"></i><b>22</b> Coffee break</a></li>
<li class="chapter" data-level="23" data-path="logistic-setting.html"><a href="logistic-setting.html"><i class="fa fa-check"></i><b>23</b> Logistic setting</a><ul>
<li class="chapter" data-level="23.1" data-path="logistic-setting.html"><a href="logistic-setting.html#simple-example-1"><i class="fa fa-check"></i><b>23.1</b> Simple Example</a><ul>
<li class="chapter" data-level="23.1.1" data-path="logistic-setting.html"><a href="logistic-setting.html#optional-odds-refresher"><i class="fa fa-check"></i><b>23.1.1</b> Optional (Odds Refresher)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="now-for-advanced-logistic-mixed-effects.html"><a href="now-for-advanced-logistic-mixed-effects.html"><i class="fa fa-check"></i><b>24</b> Now for Advanced: logistic mixed effects</a></li>
<li class="chapter" data-level="25" data-path="now-over-to-you.html"><a href="now-over-to-you.html"><i class="fa fa-check"></i><b>25</b> Now, over to you!</a><ul>
<li class="chapter" data-level="25.1" data-path="now-over-to-you.html"><a href="now-over-to-you.html#data-description"><i class="fa fa-check"></i><b>25.1</b> Data Description</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html"><i class="fa fa-check"></i><b>26</b> Introduction to Bayesian Estimation</a><ul>
<li class="chapter" data-level="26.1" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#intro-to-bayesian-estimation"><i class="fa fa-check"></i><b>26.1</b> Intro to Bayesian estimation</a><ul>
<li class="chapter" data-level="26.1.1" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#data-sets-2"><i class="fa fa-check"></i><b>26.1.1</b> Data sets</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#bayes-inference-and-one-sample-t-test"><i class="fa fa-check"></i><b>26.2</b> Bayes inference and one-sample t-test</a></li>
<li class="chapter" data-level="26.3" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#difference-between-two-groups-means"><i class="fa fa-check"></i><b>26.3</b> Difference between two groups’ means</a></li>
<li class="chapter" data-level="26.4" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#bayes-factor-example"><i class="fa fa-check"></i><b>26.4</b> Bayes Factor Example</a></li>
<li class="chapter" data-level="26.5" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#bayes-factor-and-anova"><i class="fa fa-check"></i><b>26.5</b> Bayes Factor and Anova</a><ul>
<li class="chapter" data-level="26.5.1" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#exercise-2"><i class="fa fa-check"></i><b>26.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="26.6" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#linear-models-with-bas"><i class="fa fa-check"></i><b>26.6</b> Linear models with BAS</a><ul>
<li class="chapter" data-level="26.6.1" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#bic-and-r-squared"><i class="fa fa-check"></i><b>26.6.1</b> BIC and R squared</a></li>
</ul></li>
<li class="chapter" data-level="26.7" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#predictions-from-bas.lm"><i class="fa fa-check"></i><b>26.7</b> Predictions from bas.lm</a></li>
<li class="chapter" data-level="26.8" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#examining-and-presenting-results"><i class="fa fa-check"></i><b>26.8</b> Examining and presenting results</a></li>
<li class="chapter" data-level="26.9" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#bayesian-mixed-methods-example-optional"><i class="fa fa-check"></i><b>26.9</b> Bayesian Mixed methods example (Optional)</a><ul>
<li class="chapter" data-level="26.9.1" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#data"><i class="fa fa-check"></i><b>26.9.1</b> Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="diy-2.html"><a href="diy-2.html"><i class="fa fa-check"></i><b>27</b> DIY</a><ul>
<li class="chapter" data-level="27.1" data-path="diy-2.html"><a href="diy-2.html#extra-resources-to-check"><i class="fa fa-check"></i><b>27.1</b> Extra Resources to check</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="extra-resources.html"><a href="extra-resources.html"><i class="fa fa-check"></i><b>28</b> Extra Resources</a><ul>
<li class="chapter" data-level="28.1" data-path="extra-resources.html"><a href="extra-resources.html#more-r-practice"><i class="fa fa-check"></i><b>28.1</b> More R practice</a></li>
<li class="chapter" data-level="28.2" data-path="extra-resources.html"><a href="extra-resources.html#data-cleaning-1"><i class="fa fa-check"></i><b>28.2</b> Data Cleaning</a></li>
<li class="chapter" data-level="28.3" data-path="extra-resources.html"><a href="extra-resources.html#visualisations-1"><i class="fa fa-check"></i><b>28.3</b> Visualisations</a></li>
<li class="chapter" data-level="28.4" data-path="extra-resources.html"><a href="extra-resources.html#other-common-methods-in-r"><i class="fa fa-check"></i><b>28.4</b> Other Common Methods in R</a></li>
<li class="chapter" data-level="28.5" data-path="extra-resources.html"><a href="extra-resources.html#big-data"><i class="fa fa-check"></i><b>28.5</b> Big Data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PPLS PhD Training Workshop: Statistics and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualisations" class="section level1">
<h1><span class="header-section-number">Chapter 13</span> Visualisations</h1>
<p>We now have a general feel for our data, but what does it <em>look</em> like? Visualising data is one of the most important tasks facing the data analyst. It’s important to be able to display your data clearly and coherently, as it makes you and the reader easier to understand. Plus, it helps <strong>you</strong> to understand the data.</p>
<div id="simple-plots" class="section level2">
<h2><span class="header-section-number">13.1</span> Simple Plots</h2>
<p>Before we get into using specialised graphics, let’s start by drawing a few very simple graphs to get a feel for what it’s like to draw pictures using <code>R</code>.</p>
<div id="using-plot" class="section level3">
<h3><span class="header-section-number">13.1.1</span> Using <code>plot()</code></h3>
<p>Lets create a small vector <em>Fibonacci</em> that contains a few numbers we’d like <code>R</code> to draw for us. Then, we’ll ask <code>R</code> to <code>plot()</code> those numbers:</p>
<pre class="sourceCode r"><code class="sourceCode r">Fibonacci &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">13</span>, <span class="dv">21</span>, <span class="dv">34</span>)
<span class="kw">plot</span>(Fibonacci)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<p>As you can see, what <code>R</code> has done is plot the values stored in the Fibonacci variable on the vertical axis (y-axis) and the corresponding index on the horizontal axis (x-axis). In other words, since the 4th element of the vector has a value of 3, we get a dot plotted at the location (4,3).</p>
<p>The important thing to note when using the <code>plot()</code> function, is that it’s behaviour changes depending on what kind of input you give it.</p>
</div>
</div>
<div id="customising-plots" class="section level2">
<h2><span class="header-section-number">13.2</span> Customising Plots</h2>
<div id="labels" class="section level3">
<h3><span class="header-section-number">13.2.1</span> Labels</h3>
<p>One of the first things that you’ll find yourself wanting to do when customising your plot is to label it better. The arguments that you need to specify to make this happen are:</p>
<ul>
<li><code>main</code>: A character string containing the title.</li>
<li><code>sub</code>: A character string containing the subtitle.</li>
<li><code>xlab</code>: A character string containing the x-axis label.</li>
<li><code>ylab</code>: A character string containing the y-axis label.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Fibonacci, 
   <span class="dt">main =</span> <span class="st">&quot;Main title goes here&quot;</span>,
   <span class="dt">sub =</span> <span class="st">&quot;The subtitle appears here!&quot;</span>,
   <span class="dt">xlab =</span> <span class="st">&quot;The x-axis label&quot;</span>,
   <span class="dt">ylab =</span> <span class="st">&quot;The y-axis label&quot;</span>
   )</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
<p>Don’t like the look of the plot? Then let’s change it up!</p>
<p>There are lots of graphical parameters that you can change in <code>R</code>, below we will cover the most common.</p>
<ul>
<li>Font styles: <code>font.main</code>, <code>font.sub</code>, <code>font.lab</code>, <code>font.axis</code></li>
<li>Font colours: <code>col.main</code>, <code>col.sub</code>, <code>col.lab</code>, <code>col.axis</code></li>
<li>Font size: <code>cex.main</code>, <code>cex.sub</code>, <code>cex.lab</code>, <code>cex.axis</code></li>
</ul>
<p>Let’s use some of the above to make changes to our plot:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Fibonacci, 
   <span class="dt">main =</span> <span class="st">&quot;Main title goes here&quot;</span>,
   <span class="dt">sub =</span> <span class="st">&quot;The subtitle appears here!&quot;</span>,
   <span class="dt">xlab =</span> <span class="st">&quot;The x-axis label&quot;</span>,
   <span class="dt">ylab =</span> <span class="st">&quot;The y-axis label&quot;</span>,
   <span class="dt">font.main =</span> <span class="dv">1</span>,           <span class="co"># plain text for title </span>
   <span class="dt">cex.main =</span> <span class="dv">1</span>,            <span class="co"># normal size for title</span>
   <span class="dt">font.axis =</span> <span class="dv">2</span>,           <span class="co"># bold text for numbering</span>
   <span class="dt">col.lab =</span> <span class="st">&quot;red&quot;</span>          <span class="co"># red colour for axis labels</span>
   )</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
</div>
<div id="plot-type" class="section level3">
<h3><span class="header-section-number">13.2.2</span> Plot Type</h3>
<p>But wait! There’s a lot more customisation you can do… you can also customise the appearance of the actual plot!</p>
<ul>
<li><code>type = "p"</code>. Draw the points only.</li>
<li><code>type = "l"</code>. Draw a line through the points.</li>
<li><code>type = "o"</code>. Draw the line over the top of the points.</li>
<li><code>type = "b"</code>. Draw both points and lines, but don’t over plot.</li>
<li><code>type = "h"</code>. Draw “histogram-like” vertical bars.</li>
<li><code>type = "s"</code>. Draw a staircase, going horizontally then vertically.</li>
<li><code>type = "S"</code>. Draw a Staircase, going vertically then horizontally.</li>
<li><code>type = "c"</code>. Draw only the connecting lines from the “b” version.</li>
<li><code>type = "n"</code>. Draw nothing.</li>
</ul>
<p>The simplest way to illustrate what each of these really looks like is just to draw them, so have a go! Just add in the <code>type = " "</code> argument into your code, and re-run it.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Fibonacci, 
   <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,
   <span class="dt">main =</span> <span class="st">&quot;Main title goes here&quot;</span>,
   <span class="dt">sub =</span> <span class="st">&quot;The subtitle appears here!&quot;</span>,
   <span class="dt">xlab =</span> <span class="st">&quot;The x-axis label&quot;</span>,
   <span class="dt">ylab =</span> <span class="st">&quot;The y-axis label&quot;</span>,
   <span class="dt">font.main =</span> <span class="dv">1</span>,           <span class="co"># plain text for title </span>
   <span class="dt">cex.main =</span> <span class="dv">1</span>,            <span class="co"># normal size for title</span>
   <span class="dt">font.axis =</span> <span class="dv">2</span>,           <span class="co"># bold text for numbering</span>
   <span class="dt">col.lab =</span> <span class="st">&quot;red&quot;</span>          <span class="co"># red colour for axis labels</span>
   )</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
</div>
<div id="other-customisable-features" class="section level3">
<h3><span class="header-section-number">13.2.3</span> Other Customisable Features</h3>
<p>There’s even more that you can customise too:</p>
<ul>
<li>Colour of the plot: the <code>col</code> parameter will do this for you e.g. <code>col="blue"</code></li>
<li>Character of plot points: the <code>pch</code> parameter. This tells <code>R</code> what symbol to use to draw the points on the plot e.g. <code>pch=12</code></li>
<li>Plot size: the <code>cex</code> parameter is used to change the size of your symbols e.g. <code>cex=2</code></li>
<li>Line type: the <code>lty</code> parameter is used to tell <code>R</code> which type of line to draw. You can either specify using a number between <code>0</code> and <code>1</code>, or by using a meaningful character string e.g. <code>blank</code>, <code>dashed</code>, <code>solid</code>, <code>dotdash</code></li>
<li>Line width: the <code>lwd</code> parameter can be used to specify the width of a line e.g. <code>lwd=3</code></li>
</ul>
<p>Try some of these changes out on your plots!</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Fibonacci, 
   <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,
   <span class="dt">main =</span> <span class="st">&quot;Main title goes here&quot;</span>,
   <span class="dt">sub =</span> <span class="st">&quot;The subtitle appears here!&quot;</span>,
   <span class="dt">xlab =</span> <span class="st">&quot;The x-axis label&quot;</span>,
   <span class="dt">ylab =</span> <span class="st">&quot;The y-axis label&quot;</span>,
   <span class="dt">font.main =</span> <span class="dv">1</span>,           <span class="co"># plain text for title </span>
   <span class="dt">cex.main =</span> <span class="dv">1</span>,            <span class="co"># normal size for title</span>
   <span class="dt">font.axis =</span> <span class="dv">2</span>,           <span class="co"># bold text for numbering</span>
   <span class="dt">col.lab =</span> <span class="st">&quot;red&quot;</span>,         <span class="co"># red colour for axis labels</span>
   <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>,           <span class="co"># green colour </span>
   <span class="dt">pch =</span> <span class="dv">19</span>,                <span class="co"># plot character is a solid circle</span>
   <span class="dt">cex =</span> <span class="dv">3</span>,                 <span class="co"># plot is 2x normal size</span>
   <span class="dt">lty =</span> <span class="dv">2</span>,                 <span class="co"># dashed line</span>
   <span class="dt">lwd =</span> <span class="dv">5</span>                  <span class="co"># line width 5x normal width</span>
   )</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
</div>
<div id="change-axes" class="section level3">
<h3><span class="header-section-number">13.2.4</span> Change Axes</h3>
<ul>
<li>Change plot axis scales: the <code>xlim</code> and <code>ylim</code> parameters will do this for you e.g. <code>xlim=c(0, 10)</code></li>
<li>Suppress labeling: the <code>ann</code> parameter can be used if you don’t want R to label any axis, just set it to false e.g. <code>ann=FALSE</code></li>
<li>Suppress axis drawing: the <code>axes</code> parameter is used when you don’t want R to draw any axes e.g. <code>axes=FALSE</code>. You can suppress the axes individually using the <code>xant</code> and <code>yant</code> arguments e.g. <code>xant = "n"</code>.</li>
<li>Label orientation: the <code>las</code> parameter allows you to customise the orientation of the text used to label the individual tick marks e.g. <code>las=2</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Fibonacci, 
   <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,
   <span class="dt">main =</span> <span class="st">&quot;Main title goes here&quot;</span>,
   <span class="dt">sub =</span> <span class="st">&quot;The subtitle appears here!&quot;</span>,
   <span class="dt">xlab =</span> <span class="st">&quot;The x-axis label&quot;</span>,
   <span class="dt">ylab =</span> <span class="st">&quot;The y-axis label&quot;</span>,
   <span class="dt">font.main =</span> <span class="dv">1</span>,           <span class="co"># plain text for title </span>
   <span class="dt">cex.main =</span> <span class="dv">1</span>,            <span class="co"># normal size for title</span>
   <span class="dt">font.axis =</span> <span class="dv">2</span>,           <span class="co"># bold text for numbering</span>
   <span class="dt">col.lab =</span> <span class="st">&quot;red&quot;</span>,         <span class="co"># red colour for axis labels</span>
   <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>,           <span class="co"># green colour </span>
   <span class="dt">pch =</span> <span class="dv">19</span>,                <span class="co"># plot character is a solid circle</span>
   <span class="dt">cex =</span> <span class="dv">3</span>,                 <span class="co"># plot is 2x normal size</span>
   <span class="dt">lty =</span> <span class="dv">2</span>,                 <span class="co"># dashed line</span>
   <span class="dt">lwd =</span> <span class="dv">5</span>,                 <span class="co"># line width 5x normal width</span>
   <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>),         <span class="co"># x-axis min and max values</span>
   <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">50</span>),         <span class="co"># y-axis min and max values</span>
   <span class="dt">las =</span> <span class="dv">2</span>                  <span class="co"># changed orientation of text</span>
   )</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
</div>
</div>
<div id="dont-panic" class="section level2">
<h2><span class="header-section-number">13.3</span> Don’t Panic!</h2>
<p>You might be thinking, <em>“geez, is it really that difficult to draw a simple plot!?”</em> The answer is no. We have covered the majority of customisations that you <em>can</em> do, but chances are in reality you’ll use relatively few of these arguments. It’s just useful to see what you are able to do with the simple <code>plot()</code> function.</p>
</div>
<div id="other-simple-plots" class="section level2">
<h2><span class="header-section-number">13.4</span> Other Simple Plots</h2>
<div id="histograms" class="section level3">
<h3><span class="header-section-number">13.4.1</span> Histograms</h3>
<p>Histograms are simple and useful ways to visualise data, and make most sense to use when you have interval or ratio scale data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Fibonacci)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Fibonacci, <span class="dt">breaks =</span> <span class="dv">3</span>) <span class="co">#add in number of bins</span></code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-90-2.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Fibonacci, <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">40</span>) <span class="co">#add in where breaks should start and finish</span></code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-90-3.png" width="672" /></p>
<p>You can <em>of course</em> customise your histogram:</p>
<ul>
<li>Shading lines: the <code>density</code> and <code>angle</code> arguments will allow you to: (1) add diagonal lines to your bars, and (2) indicate the angle of the lines e.g. <code>density = 1</code> and <code>angle = 45</code></li>
<li>Colours: like <code>plot()</code>, you can use the <code>col</code> parameter to change the colour of the shading of the interiors of the bars. You can also use the <code>border</code> argument to set the colour of the bar borders</li>
<li>Labels: you can label each of the bars in your histogram using the <code>labels</code> argument. You can either write <code>labels = TRUE</code>, or you can choose the labels yourself, by giving a vector of strings e.g. <code>lables = c("Label 1", "Label 2")</code></li>
</ul>
<p>Try adding some of these components to your histogram.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Fibonacci, 
     <span class="dt">breaks =</span> <span class="dv">15</span>,     <span class="co">#add in number of bins</span>
    <span class="dt">density =</span> <span class="dv">5</span>,      <span class="co">#5 shading lines per inch</span>
    <span class="dt">angle =</span> <span class="dv">75</span>,       <span class="co">#angle of 75 degrees for shading lines</span>
    <span class="dt">border =</span> <span class="st">&quot;blue&quot;</span>,  <span class="co">#set border colour to blue</span>
    <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,      <span class="co">#set colour of shading lines</span>
    <span class="dt">labels =</span> <span class="ot">TRUE</span>,    <span class="co">#add frequency labels to the bars</span>
    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>)     <span class="co">#y-axis min and max</span>
    )</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
</div>
<div id="boxplots" class="section level3">
<h3><span class="header-section-number">13.4.2</span> Boxplots</h3>
<p>Boxplots are another useful way of visualising interval or ratio data. They provide you with the information that you see when using the <code>summary()</code> function, and are useful for providing a visual illustration of the median, interquartile range, and the overall range of data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(Fibonacci)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(Fibonacci)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.000   2.000   5.000   9.778  13.000  34.000</code></pre>
<p>There you have it - your first boxplot. But why is there a circle at the top? It’s because, by default, <code>R</code> highlights cases that are 1.5x the interquartle range. That means that the top whisker is pulled back to the next highest value that is within the range. You can change this, by specifying the <code>range</code> argument.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(Fibonacci, <span class="dt">range =</span> <span class="dv">2</span>)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<div id="customising-boxplots" class="section level4">
<h4><span class="header-section-number">13.4.2.1</span> Customising Boxplots</h4>
<p>There are (of course) lots of ways that you can customise your boxplots. You can change the width of various parts of the plots, change the line-types, -colours, and -widths, change the fill and background colours, and change the point characters and expansions. You can also change the orientation of the plot, as well as the width of each box so that they are proportional to your data. You can use the <code>R</code> help function to see how to make these customisations.</p>
<pre class="sourceCode r"><code class="sourceCode r">?boxplot
<span class="kw">boxplot</span>(Fibonacci,
       <span class="dt">boxlwd =</span> <span class="dv">2</span>,          <span class="co"># box line width 2</span>
       <span class="dt">whisklwd =</span> <span class="dv">5</span>,        <span class="co"># whisker line width 5</span>
       <span class="dt">outlwd =</span> <span class="dv">2</span>,          <span class="co"># outlier line width 2</span>
       <span class="dt">boxlty =</span> <span class="dv">2</span>,          <span class="co"># dashed box line </span>
       <span class="dt">staplecol =</span> <span class="st">&quot;blue&quot;</span>,
       <span class="dt">medcol =</span> <span class="st">&quot;green&quot;</span>,
       <span class="dt">boxfill =</span> <span class="st">&quot;yellow&quot;</span>,
       <span class="dt">outpch =</span> <span class="dv">5</span>,
       <span class="dt">varwidth =</span> T,
       <span class="dt">horizontal =</span> T
       )</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
</div>
</div>
<div id="scatterplots" class="section level3">
<h3><span class="header-section-number">13.4.3</span> Scatterplots</h3>
<p>We’ve already created an example of a scatterplot - the original Fibonacci graph when you used the <code>plot()</code> function. Scatterplots can be really useful tools in data visualisation, especially when looking at the <em>relationship</em> between variables.</p>
<p>Let’s use some the <code>data</code> data you created earlier. Just to remind yourself of whats in there, <code>head</code> the <code>mydata</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(mydata)</code></pre>
<pre><code>##   age    sex group score
## 1  20   male   low    70
## 2  22   male   low    89
## 3  49   male   low    56
## 4  41   male   low    60
## 5  35   male  high    68
## 6  47 female  high    62</code></pre>
<p>Now, lets look at the relationship between <code>age</code> and <code>score</code>. We again will use the <code>plot()</code> function, and specify the <code>x (age)</code> and <code>y (score)</code> variables that we want plotted:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mydata<span class="op">$</span>age, mydata<span class="op">$</span>score)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
<p>We can do better than this plot with all the fancy tricks we learned above! Try to give the plot a main title, axis labels, and change the colour of the dots too.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mydata<span class="op">$</span>age, mydata<span class="op">$</span>score,
     <span class="dt">main =</span> <span class="st">&quot;Relationship between Age and Score&quot;</span>,
     <span class="dt">xlab =</span> <span class="st">&quot;Age&quot;</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;Score&quot;</span>,
     <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>,
     <span class="dt">pch =</span> <span class="dv">12</span>
     )</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
<p>We can see that there seems to be a negative relationship between age and score - as age increases, score decreases. You might want to get <code>R</code> to draw a nice clean straight line to highlight this trajectory, and one way to do so is by using the <code>scatterplot</code> function within the <code>car</code> package. Before you use this function, you will need to install and load the package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(car)</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     logit</code></pre>
<p>We can now use the function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">scatterplot</span>(mydata<span class="op">$</span>age, mydata<span class="op">$</span>score, <span class="dt">smooth =</span> F) <span class="co">#smooth stops R from drawing a fancy &quot;smoothed&quot; trendline</span></code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<p>As well as a scatterplot, <code>R</code> has also given us boxplots for each of the two variables, as well as a line of best fit to show the relationship between the two variables. You can also fit an <code>abline</code> in a normal plot, and you’ll see an example of this at a later time.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(mydata)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
</div>
</div>
<div id="how-to-save-image-files" class="section level2">
<h2><span class="header-section-number">13.5</span> How to Save Image Files</h2>
<p>In RStudio, the easiest way to save an image is to click <em>Export</em> in the Plot panel. You can then either “Save Plot as PDF” or “Save Plot as image”. Of course, there is also a way to write code to tell <code>R</code> to do this for you, it just involves a couple of extra steps.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 1. Open png file</span>
<span class="kw">png</span>(<span class="st">&quot;rplot.png&quot;</span>)

<span class="co"># 2. Create the plot</span>
<span class="kw">scatterplot</span>(mydata<span class="op">$</span>age, mydata<span class="op">$</span>score, <span class="dt">smooth =</span> F)

<span class="co"># 3. Close the file</span>
<span class="kw">dev.off</span>()</code></pre>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<p>There you have it! You should now have a plot saved in the directory you are working in.</p>
</div>
<div id="plotting-with-ggplot2" class="section level2">
<h2><span class="header-section-number">13.6</span> Plotting with <code>ggplot2</code></h2>
<p>A little earlier on, we installed and loaded the <code>ggplot2</code> package that I said we’d use later for visualising data. That time has now come!</p>
<p><code>ggplot2</code> provides two main plotting functions: <code>qplot()</code> for quick plots useful for data exploration and <code>ggplot()</code> for fully customisable publication-quality plots.</p>
<p>Let’s first look at <code>qplot()</code>.</p>
<p>If we give it a single numeric vector (or column), we will get a histogram:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(mydata<span class="op">$</span>score)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<p>If we give it a categorical variable (character vector or factor), it will give us a bar chart:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(mydata<span class="op">$</span>sex)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
<p>If we give it two continuous variables, it will give us a scatterplot:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(mydata<span class="op">$</span>age, mydata<span class="op">$</span>score)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
<p>The <code>geom =</code> argument specifies which plotting element (geom) to use. For instance, if we want a boxplot of a continuous variable by categorical variable, we can do:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(mydata<span class="op">$</span>group, mydata<span class="op">$</span>score, <span class="dt">geom =</span> <span class="st">&quot;boxplot&quot;</span>)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-105-1.png" width="672" /></p>
<p>You can specify several geoms in a single <code>qplot</code>. For example, we may want to overlay a regression line over our scatterplot showing the relationship between age and score. To do this, we need to tell <code>qplot()</code> to use both geom point and geom smooth.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(mydata<span class="op">$</span>age, mydata<span class="op">$</span>score, <span class="dt">geom =</span> <span class="kw">c</span>(<span class="st">&quot;point&quot;</span>, <span class="st">&quot;smooth&quot;</span>))</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
<div id="ggplot" class="section level3">
<h3><span class="header-section-number">13.6.1</span> <code>ggplot()</code></h3>
<p>Using these plots is a little different from what we’ve seen so far and there are 3 key things to keep in mind 1) aesthetic: what you want to graph (e.g. x, y, z); 2) geom: how you want to graph it; and 3) optional extras - titles, themes, backgrounds etc.</p>
<p>Unlike <code>qplot()</code>, plots with <code>ggplot()</code> are constructed in a layered fashion. The bottom layer constructs the plotting space to which you then add layers of geoms, legends, axes, and what not.</p>
<p>Everything can be customised, such as the geometries you apply to your plot:</p>
<p><em>For one variable</em>:
* <code>+ geom_dotplot()</code> adds a dotplot geometry to the graph.
* <code>+ geom_histogram()</code> adds a histogram geometry to the graph.
* <code>+ geom_violin()</code> adds a violin plot geometry to the graph.</p>
<p><em>For two variables</em>:
* <code>+ geom_point()</code> adds a point (scatterplot) geometry to the graph.
* <code>+ geom_smooth()</code> adds a smoother to the graph.</p>
</div>
<div id="iris-example" class="section level3">
<h3><span class="header-section-number">13.6.2</span> Iris Example</h3>
<p><code>ggplot()</code> has pre-saved data within the package. Let’s make use of this for the time being as we take a look at what `ggplot()’ can do.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(iris) <span class="co">#see what data we have </span></code></pre>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<p>A scatterplot:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color=</span>Species, <span class="dt">shape=</span>Species)) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Sepal Length&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Sepal Width&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Sepal Length-Width&quot;</span>)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
<p>A boxplot:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>iris, <span class="kw">aes</span>(<span class="dt">x=</span>Species, <span class="dt">y=</span>Sepal.Length)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>Species)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Sepal Length&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Iris Boxplot&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y=</span>mean, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, <span class="dt">shape=</span><span class="dv">5</span>, <span class="dt">size=</span><span class="dv">4</span>) </code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>
<p>A histogram:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>iris, <span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Width)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="fl">0.2</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="kw">aes</span>(<span class="dt">fill=</span>Species)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Sepal Width&quot;</span>) <span class="op">+</span><span class="st">  </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Histogram of Sepal Width&quot;</span>)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
<p>A violin plot:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_density</span>(<span class="kw">aes</span>(<span class="dt">ymax =</span> ..density..,  <span class="dt">ymin =</span> <span class="op">-</span>..density.., 
                   <span class="dt">fill =</span> Species, <span class="dt">color =</span> Species), 
                   <span class="dt">geom =</span> <span class="st">&quot;ribbon&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>Species) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Sepal Length&quot;</span>) </code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
</div>
<div id="ggplot-with-our-mydata-file" class="section level3">
<h3><span class="header-section-number">13.6.3</span> <code>ggplot()</code> with our <code>mydata</code> file</h3>
<p>Let’s start with a simple histogram of the <code>score</code> variable:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mydata, <span class="kw">aes</span>(score)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>()</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<p>Now lets make a scatterplot:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mydata, <span class="kw">aes</span>(age, score)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
<p>Like the simple plots, we can also customise. Lets change the colour, size, and shape of the points:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mydata, <span class="kw">aes</span>(age, score)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">pch =</span> <span class="dv">10</span>)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
<p>What if you want to colour the points by <code>group</code>? To do this, we need to specify colour as an aesthetic mapping it to the desired variable:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mydata, <span class="kw">aes</span>(age, score)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> group))</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-115-1.png" width="672" /></p>
<p>In this case, it doesn’t really matter if you put the individual aesthetics inside of the <code>ggplot()</code> or the <code>geom_point()</code> function. The difference is that whatever you put into the top layer (<code>ggplot()</code>) will get passed on to all the subsequent geoms, while the aesthetic you give to a particular geom will only apply to it. To illustrate this point, let’s add a regression line:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mydata, <span class="kw">aes</span>(age, score)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> group)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
<p>Note that the order of your arguments matter. Since <code>colour = group</code> is given to <code>geom_point()</code>, it doesn’t impact <code>geom_smooth()</code> which only draws one line. If we want <code>geom_smooth</code> to draw one line per <code>group</code> point, we can just move the <code>colour =</code> argument to the topmost <code>ggplot()</code> layer:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mydata, <span class="kw">aes</span>(age, score, <span class="dt">colour =</span> group)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-117-1.png" width="672" /></p>
<p>You can also store these plots as objects, and add more layers:</p>
<pre class="sourceCode r"><code class="sourceCode r">plot1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mydata, <span class="kw">aes</span>(age, score, <span class="dt">colour =</span> group)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)

plot1 <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-118-1.png" width="672" /></p>
<p>What about when we combine all of our variables onto the one plot?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mydata, <span class="kw">aes</span>(<span class="dt">x=</span>age,<span class="dt">y =</span>score, <span class="dt">colour =</span> group)) <span class="op">+</span><span class="st"> </span>
<span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape=</span><span class="kw">factor</span>(sex)),<span class="dt">size =</span><span class="dv">2</span>) <span class="op">+</span><span class="st">  </span>
<span class="kw">scale_shape</span>(<span class="dt">solid=</span><span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span>
<span class="kw">geom_line</span>() <span class="op">+</span>
<span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;black&quot;</span>, <span class="st">&quot;green&quot;</span>))</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-119-1.png" width="672" /></p>
</div>
</div>
<div id="bring-it-all-together" class="section level2">
<h2><span class="header-section-number">13.7</span> Bring It All Together</h2>
<p>Let’s now work through an example together from the very start. We’ll be working with the animals.csv file.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Step 1: Read in data</span>
animals &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;animals.csv&quot;</span>, <span class="dt">header =</span> T)

<span class="co">#Step 2: Load packages</span>
<span class="kw">library</span>(psych)
<span class="kw">library</span>(ggplot2)

<span class="co">#Step 3: Data Familiarisation</span>
<span class="kw">str</span>(animals)</code></pre>
<pre><code>## &#39;data.frame&#39;:    40 obs. of  2 variables:
##  $ animal: Factor w/ 4 levels &quot;Cougar&quot;,&quot;Dog&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ score : int  3 5 3 1 4 3 2 3 4 2 ...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(animals)</code></pre>
<pre><code>##   animal score
## 1 Cougar     3
## 2 Cougar     5
## 3 Cougar     3
## 4 Cougar     1
## 5 Cougar     4
## 6 Cougar     3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(animals)</code></pre>
<pre><code>##       animal       score      
##  Cougar  :10   Min.   : 1.00  
##  Dog     :10   1st Qu.: 2.00  
##  HouseCat:10   Median : 5.00  
##  Wolf    :10   Mean   : 5.15  
##                3rd Qu.: 8.00  
##                Max.   :10.00</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Step 4: Clean Data - max score is 9</span>
animals1 &lt;-<span class="st"> </span><span class="kw">scrub</span>(animals, <span class="dt">where =</span> <span class="dv">2</span>, <span class="dt">min =</span> <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">40</span>), <span class="dt">max =</span> <span class="kw">rep</span>(<span class="dv">9</span>, <span class="dv">40</span>))
<span class="kw">summary</span>(animals1)</code></pre>
<pre><code>##       animal       score      
##  Cougar  :10   Min.   :1.000  
##  Dog     :10   1st Qu.:2.000  
##  HouseCat:10   Median :4.000  
##  Wolf    :10   Mean   :4.611  
##                3rd Qu.:7.000  
##                Max.   :9.000  
##                NA&#39;s   :4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Step 5: Describe data</span>
<span class="kw">describe</span>(animals1)</code></pre>
<pre><code>##         vars  n mean   sd median trimmed  mad min max range skew kurtosis
## animal*    1 40 2.50 1.13    2.5    2.50 1.48   1   4     3 0.00    -1.44
## score      2 36 4.61 2.89    4.0    4.53 3.71   1   9     8 0.22    -1.52
##           se
## animal* 0.18
## score   0.48</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">describeBy</span>(animals1<span class="op">$</span>score, <span class="dt">group =</span> animals1<span class="op">$</span>animal)</code></pre>
<pre><code>## 
##  Descriptive statistics by group 
## group: Cougar
##    vars  n mean   sd median trimmed  mad min max range skew kurtosis   se
## X1    1 10    3 1.15      3       3 1.48   1   5     4    0    -0.97 0.37
## -------------------------------------------------------- 
## group: Dog
##    vars n mean   sd median trimmed mad min max range  skew kurtosis   se
## X1    1 6  8.5 0.84      9     8.5   0   7   9     2 -0.85    -1.17 0.34
## -------------------------------------------------------- 
## group: HouseCat
##    vars  n mean  sd median trimmed  mad min max range skew kurtosis   se
## X1    1 10  1.6 0.7    1.5     1.5 0.74   1   3     2 0.56    -1.08 0.22
## -------------------------------------------------------- 
## group: Wolf
##    vars  n mean  sd median trimmed  mad min max range skew kurtosis   se
## X1    1 10  6.9 1.2      7    6.88 1.48   5   9     4 0.17    -1.18 0.38</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Step 6: Simple Visualisations</span>

<span class="kw">plot</span>(animals1<span class="op">$</span>score <span class="op">~</span><span class="st"> </span>animals1<span class="op">$</span>animal,
     <span class="dt">xlab =</span> <span class="st">&quot;Animal&quot;</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;Score&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;Scores by Animal&quot;</span>,
     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>)
     )</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Step 7: ggplot </span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">na.omit</span>(<span class="kw">subset</span>(animals1, <span class="dt">select =</span> <span class="kw">c</span>(animal, score))), <span class="kw">aes</span>(<span class="dt">x=</span>animal, <span class="dt">y=</span>score, <span class="dt">fill =</span> animal))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Scores by Animal&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Animal&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Score&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Type of Animal&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">10</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-120-2.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="st">&quot;myplot.png&quot;</span>) <span class="co"># Save ggplot as png file</span></code></pre>
<pre><code>## Saving 7 x 5 in image</code></pre>
</div>
<div id="write-out-files" class="section level2">
<h2><span class="header-section-number">13.8</span> Write Out Files</h2>
<p>The R base functions <code>write.table()</code> and <code>write.csv()</code>can be used to export a data frame or a matrix to a file. Try to write out your <code>mydata</code> and `animal1’ files using these two functions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.table</span>(animals, <span class="st">&quot;animals1.txt&quot;</span>, <span class="dt">sep=</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)
<span class="kw">write.csv</span>(mydata, <span class="dt">file =</span> <span class="st">&quot;mydata.csv&quot;</span>)</code></pre>
</div>
<div id="questions" class="section level2">
<h2><span class="header-section-number">13.9</span> Questions</h2>
<p>Basic rule for learning, and especially for programming life: If you don’t know it, <strong>Google it!</strong>. There are lots of helpful resources out there, you just need to look them up.</p>
<p>As you will have hopefully seen today, the best way to learn in <code>R</code> is to experiment and make mistakes. If you don’t understand what a line of code or a command is doing, play around with it to try and understand what its doing.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="summary-statistics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="diy.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-intro.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
