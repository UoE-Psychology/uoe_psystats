<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Testing the assumptions | Data Analysis for Psychology Using R</title>
  <meta name="description" content="This is the main page of the course and contains a course overview, schedule and learning outcomes." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Testing the assumptions | Data Analysis for Psychology Using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the main page of the course and contains a course overview, schedule and learning outcomes." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Testing the assumptions | Data Analysis for Psychology Using R" />
  
  <meta name="twitter:description" content="This is the main page of the course and contains a course overview, schedule and learning outcomes." />
  

<meta name="author" content="Department of Psychology, University of Edinburgh" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple-linear-model-and-mixed-methods.html">
<link rel="next" href="coffee-break.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PPLS Summer Training (R and Stats)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview of the Course</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#programme"><i class="fa fa-check"></i>Programme</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#learning-outcomes"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#preparation"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#expectations"><i class="fa fa-check"></i>Expectations</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-team"><i class="fa fa-check"></i>The team</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#list-of-extra-resources"><i class="fa fa-check"></i>List of extra resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authorship"><i class="fa fa-check"></i>Authorship</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#last-but-not-least"><i class="fa fa-check"></i>Last, but not least</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="extra-resources.html"><a href="extra-resources.html"><i class="fa fa-check"></i><b>1</b> Extra Resources</a><ul>
<li class="chapter" data-level="1.1" data-path="extra-resources.html"><a href="extra-resources.html#more-r-practice"><i class="fa fa-check"></i><b>1.1</b> More R practice</a></li>
<li class="chapter" data-level="1.2" data-path="extra-resources.html"><a href="extra-resources.html#data-cleaning"><i class="fa fa-check"></i><b>1.2</b> Data Cleaning</a></li>
<li class="chapter" data-level="1.3" data-path="extra-resources.html"><a href="extra-resources.html#visualisations"><i class="fa fa-check"></i><b>1.3</b> Visualisations</a></li>
<li class="chapter" data-level="1.4" data-path="extra-resources.html"><a href="extra-resources.html#other-common-methods-in-r"><i class="fa fa-check"></i><b>1.4</b> Other Common Methods in R</a></li>
<li class="chapter" data-level="1.5" data-path="extra-resources.html"><a href="extra-resources.html#big-data"><i class="fa fa-check"></i><b>1.5</b> Big Data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>2</b> Introduction to R and RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#first-step"><i class="fa fa-check"></i><b>2.1</b> First Step</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#second-step"><i class="fa fa-check"></i><b>2.2</b> Second Step</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#r-as-an-interactive-envrionment"><i class="fa fa-check"></i><b>2.3</b> R as an interactive envrionment</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#setting-up-your-working-directory"><i class="fa fa-check"></i><b>2.4</b> Setting Up Your Working Directory</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#spacing"><i class="fa fa-check"></i><b>2.5</b> Spacing</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#typos"><i class="fa fa-check"></i><b>2.6</b> Typos</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#unfinishe.-d"><i class="fa fa-check"></i><b>2.7</b> Unfinisheâ€¦. d</a></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#basic-arithmetic"><i class="fa fa-check"></i><b>2.8</b> Basic Arithmetic</a></li>
<li class="chapter" data-level="2.9" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#using-functions-for-calculations"><i class="fa fa-check"></i><b>2.9</b> Using Functions for Calculations</a></li>
<li class="chapter" data-level="2.10" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#short-example"><i class="fa fa-check"></i><b>2.10</b> Short Example</a></li>
<li class="chapter" data-level="2.11" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#exercise-1"><i class="fa fa-check"></i><b>2.11</b> Exercise 1</a></li>
<li class="chapter" data-level="2.12" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#exercise-2"><i class="fa fa-check"></i><b>2.12</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html"><i class="fa fa-check"></i><b>3</b> Tests and modelling in R</a><ul>
<li class="chapter" data-level="3.1" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#hypothesis-testing"><i class="fa fa-check"></i><b>3.1</b> Hypothesis testing</a></li>
<li class="chapter" data-level="3.2" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#t-test"><i class="fa fa-check"></i><b>3.2</b> T test</a></li>
<li class="chapter" data-level="3.3" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#chi-squared-distribution-and-test"><i class="fa fa-check"></i><b>3.3</b> Chi squared distribution and test</a><ul>
<li class="chapter" data-level="3.3.1" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#contingency-tables"><i class="fa fa-check"></i><b>3.3.1</b> Contingency tables</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#chi-squared-distribution"><i class="fa fa-check"></i><b>3.4</b> Chi squared distribution</a></li>
<li class="chapter" data-level="3.5" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#one-way-anova"><i class="fa fa-check"></i><b>3.5</b> One way Anova</a></li>
<li class="chapter" data-level="3.6" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#sharks-and-ice-cream-example"><i class="fa fa-check"></i><b>3.6</b> Sharks and ice cream example</a></li>
<li class="chapter" data-level="3.7" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#simple-linear-regression-in-r"><i class="fa fa-check"></i><b>3.7</b> Simple Linear Regression in R</a></li>
<li class="chapter" data-level="3.8" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#regression-diagnostics---assess-the-validity-of-a-model"><i class="fa fa-check"></i><b>3.8</b> Regression Diagnostics - assess the validity of a model</a><ul>
<li class="chapter" data-level="3.8.1" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#violations-of-the-assumptions-available-treatments"><i class="fa fa-check"></i><b>3.8.1</b> Violations of the assumptions: available treatments</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#standardisation"><i class="fa fa-check"></i><b>3.9</b> Standardisation</a></li>
<li class="chapter" data-level="3.10" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#interaction-simple-slope-and-multiple-explanatory-factors"><i class="fa fa-check"></i><b>3.10</b> Interaction (simple slope) and multiple explanatory factors</a></li>
<li class="chapter" data-level="3.11" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#aic-bic"><i class="fa fa-check"></i><b>3.11</b> AIC &amp; BIC</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html"><i class="fa fa-check"></i><b>4</b> Simple Linear Model and Mixed Methods</a><ul>
<li class="chapter" data-level="4.1" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#data-sets"><i class="fa fa-check"></i><b>4.1</b> Data sets</a></li>
<li class="chapter" data-level="4.2" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#longitudinal-data"><i class="fa fa-check"></i><b>4.2</b> Longitudinal Data</a></li>
<li class="chapter" data-level="4.3" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#why-a-new-model"><i class="fa fa-check"></i><b>4.3</b> Why a new model?</a></li>
<li class="chapter" data-level="4.4" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#ecological-fallacy-quick-illustration---no-need-to-run"><i class="fa fa-check"></i><b>4.4</b> Ecological Fallacy (quick illustration) - no need to run</a></li>
<li class="chapter" data-level="4.5" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#simple-example"><i class="fa fa-check"></i><b>4.5</b> Simple Example</a></li>
<li class="chapter" data-level="4.6" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#now-for-advanced-model-set-up"><i class="fa fa-check"></i><b>4.6</b> Now for Advanced: Model set up</a><ul>
<li class="chapter" data-level="4.6.1" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#pooling"><i class="fa fa-check"></i><b>4.6.1</b> Pooling</a></li>
<li class="chapter" data-level="4.6.2" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#no-pooling"><i class="fa fa-check"></i><b>4.6.2</b> No pooling</a></li>
<li class="chapter" data-level="4.6.3" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#partial-pooling-varying-intercepts"><i class="fa fa-check"></i><b>4.6.3</b> Partial Pooling (varying intercepts)</a></li>
<li class="chapter" data-level="4.6.4" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#partial-pooling-extended---varying-intercepts-andor-slopes"><i class="fa fa-check"></i><b>4.6.4</b> Partial Pooling Extended - (varying intercepts and/or slopes)</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#multilevel-modelling-with-random-intercepts-and-slopes"><i class="fa fa-check"></i><b>4.7</b> Multilevel modelling with random intercepts and slopes</a><ul>
<li class="chapter" data-level="4.7.1" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#overview-of-the-data-set"><i class="fa fa-check"></i><b>4.7.1</b> Overview of the data set</a></li>
<li class="chapter" data-level="4.7.2" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#prepare"><i class="fa fa-check"></i><b>4.7.2</b> Prepare</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#random-slopes-intercepts-and-cross-level-interactions-optional"><i class="fa fa-check"></i><b>4.8</b> Random slopes, intercepts and cross level interactions (optional)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="testing-the-assumptions.html"><a href="testing-the-assumptions.html"><i class="fa fa-check"></i><b>5</b> Testing the assumptions</a></li>
<li class="chapter" data-level="6" data-path="coffee-break.html"><a href="coffee-break.html"><i class="fa fa-check"></i><b>6</b> Coffee break</a></li>
<li class="chapter" data-level="7" data-path="logistic-setting.html"><a href="logistic-setting.html"><i class="fa fa-check"></i><b>7</b> Logistic setting</a><ul>
<li class="chapter" data-level="7.1" data-path="logistic-setting.html"><a href="logistic-setting.html#simple-example-1"><i class="fa fa-check"></i><b>7.1</b> Simple Example</a><ul>
<li class="chapter" data-level="7.1.1" data-path="logistic-setting.html"><a href="logistic-setting.html#optional-odds-refresher"><i class="fa fa-check"></i><b>7.1.1</b> Optional (Odds Refresher)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="now-for-advanced-logistic-mixed-effects.html"><a href="now-for-advanced-logistic-mixed-effects.html"><i class="fa fa-check"></i><b>8</b> Now for Advanced: logistic mixed effects</a></li>
<li class="chapter" data-level="9" data-path="now-over-to-you.html"><a href="now-over-to-you.html"><i class="fa fa-check"></i><b>9</b> Now, over to you!</a><ul>
<li class="chapter" data-level="9.1" data-path="now-over-to-you.html"><a href="now-over-to-you.html#data-description"><i class="fa fa-check"></i><b>9.1</b> Data Description</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="week-4.html"><a href="week-4.html"><i class="fa fa-check"></i><b>10</b> week 4</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis for Psychology Using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="testing-the-assumptions" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Testing the assumptions</h1>
<p>When it comes to checking assumptions in linear mixed models, we are pretty much looking for the same things and are concerned with the behavior of the error term. Consequently, we want to check for homoscedasiticity of the error term as well as normality of the error termâ€™s distribution. We also want to make sure there is no auto correlation. We will provide you with code that can be used to test those but what will vary of course is that depending on which dataset you use, you may find yourself with violations of certain assumptions. Bare in mind as well as the estimation here is based on MLE.</p>
<p>Letâ€™s work with the example we had earlier. I would like to work with the schools data again and check that the assumptions are satisfied.</p>
<p>Crucially, we care about:</p>
<ul>
<li>Linearity</li>
<li>Normality of the residuals</li>
<li>Homogeneity of residual variance (homoscedasticity)</li>
<li>No autoccorelation and no multicolinearity</li>
</ul>
<p>Luckily, there are quite a few packages out there that can get out nice plots without much effort, including those that are inbuilt in lme4 package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Check for linearity</span>
linearity&lt;-<span class="kw">plot</span>(<span class="kw">resid</span>(model_schools_IQ),<span class="co">#extract the residuals</span>
                schools<span class="op">$</span>lang_score) <span class="co">#specify original y variable</span></code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Check for normality</span>
<span class="kw">qqmath</span>(model_schools_IQ)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>These are just few examples of sort of in built ways but I want to share with you something which does much greater job in one go. We will use package <code>sjPlot</code>, just to note quickly, this package tend to get updated from time to time so some functions may change but I am confident people will keep updating it to add more features:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#We ll need few packages</span>
<span class="kw">library</span>(effects)
<span class="kw">library</span>(sjPlot)
<span class="co">#Try with model_plot (argument for type can be varied)</span>
<span class="kw">plot_model</span>(model_schools_IQ, <span class="dt">type=</span><span class="st">&#39;diag&#39;</span>) <span class="co"># you can ajust type (see package info: ?plot_model)</span></code></pre>
<pre><code>## [[1]]</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<pre><code>## 
## [[2]]
## [[2]]$school</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-59-2.png" width="672" /></p>
<pre><code>## 
## 
## [[3]]</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-59-3.png" width="672" /></p>
<pre><code>## 
## [[4]]</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-59-4.png" width="672" /></p>
<p>We might be mostly happy here, but I personally not convinced that homescedasticity was satisfied. Lets treat this formally, whilst we are here:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(robustlmm)
<span class="co">#Reestimate the model with robust errors</span>
model_schools_IQ_robust &lt;-<span class="st"> </span><span class="kw">rlmer</span>(lang_score <span class="op">~</span><span class="st"> </span>IQ_verb <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>school), <span class="dt">data =</span> schools)

<span class="co">#Remember the old model</span>
model_schools_IQ &lt;-<span class="st"> </span><span class="kw">lmer</span>(lang_score <span class="op">~</span><span class="st"> </span>IQ_verb <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>school), <span class="dt">data =</span> schools)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Summary (before)</span>
<span class="kw">summary</span>(model_schools_IQ)</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: lang_score ~ IQ_verb + (1 | school)
##    Data: schools
## 
## REML criterion at convergence: 24917.1
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.1952 -0.6378  0.0659  0.7098  3.2132 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  school   (Intercept)  9.909   3.148   
##  Residual             40.479   6.362   
## Number of obs: 3758, groups:  school, 211
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept) 41.05442    0.24402  168.24
## IQ_verb      2.50722    0.05439   46.09
## 
## Correlation of Fixed Effects:
##         (Intr)
## IQ_verb 0.003</code></pre>
<p>Note a slight change in the estimates and standard errors.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Summary(robust)</span>
<span class="kw">summary</span>(model_schools_IQ_robust)</code></pre>
<pre><code>## Robust linear mixed model fit by DAStau 
## Formula: lang_score ~ IQ_verb + (1 | school) 
##    Data: schools 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -4.5850 -0.6589  0.0366  0.6654  3.2090 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  school   (Intercept)  9.561   3.092   
##  Residual             40.340   6.351   
## Number of obs: 3758, groups: school, 211
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept) 41.34622    0.24666  167.63
## IQ_verb      2.52844    0.05566   45.42
## 
## Correlation of Fixed Effects:
##         (Intr)
## IQ_verb 0.003 
## 
## Robustness weights for the residuals: 
##  3022 weights are ~= 1. The remaining 736 ones are summarized as
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.293   0.695   0.842   0.807   0.950   0.999 
## 
## Robustness weights for the random effects: 
##  177 weights are ~= 1. The remaining 34 ones are summarized as
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.537   0.668   0.821   0.801   0.928   0.998 
## 
## Rho functions used for fitting:
##   Residuals:
##     eff: smoothed Huber (k = 1.345, s = 10) 
##     sig: smoothed Huber, Proposal II (k = 1.345, s = 10) 
##   Random Effects, variance component 1 (school):
##     eff: smoothed Huber (k = 1.345, s = 10) 
##     vcp: smoothed Huber, Proposal II (k = 1.345, s = 10)</code></pre>
<p>Lets check visually. Unfortunately, we cannot use plot_model() on rlmer object but there is a plot which comes with the package so we can still get some quick visualisations.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Plot</span>
<span class="kw">plot</span>(model_schools_IQ_robust)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-63-1.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-63-2.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-63-3.png" width="672" /></p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-linear-model-and-mixed-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="coffee-break.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/Week_3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
