<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 5 Bayesian Mixed methods example | PPLS PhD Training Workshop: Statistics and R</title>
  <meta name="description" content="This is the main page of the course and contains a course overview, schedule and learning outcomes.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 5 Bayesian Mixed methods example | PPLS PhD Training Workshop: Statistics and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the main page of the course and contains a course overview, schedule and learning outcomes." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Bayesian Mixed methods example | PPLS PhD Training Workshop: Statistics and R" />
  
  <meta name="twitter:description" content="This is the main page of the course and contains a course overview, schedule and learning outcomes." />
  

<meta name="author" content="Anastasia Ushakova and Emma Waterston">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introduction-to-bayesian-estimation.html">
<link rel="next" href="diy.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PPLS Summer Training (R and Stats)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview of the Course</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#programme"><i class="fa fa-check"></i>Programme</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#learning-outcomes"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#preparation"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#data-sets"><i class="fa fa-check"></i>Data sets</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#expectations"><i class="fa fa-check"></i>Expectations</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lets-stay-in-touch"><i class="fa fa-check"></i>Lets stay in touch</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#list-of-extra-resources"><i class="fa fa-check"></i>List of extra resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authorship"><i class="fa fa-check"></i>Authorship</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#last-but-not-least"><i class="fa fa-check"></i>Last, but not least</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html"><i class="fa fa-check"></i><b>1</b> Getting Started in RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#r-as-an-interactive-envrionment"><i class="fa fa-check"></i><b>1.1</b> R as an interactive envrionment</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#setting-up-your-working-directory"><i class="fa fa-check"></i><b>1.2</b> Setting Up Your Working Directory</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#spacing"><i class="fa fa-check"></i><b>1.3</b> Spacing</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#typos"><i class="fa fa-check"></i><b>1.4</b> Typos</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#unfinishe.-d"><i class="fa fa-check"></i><b>1.5</b> Unfinishe…. d</a></li>
<li class="chapter" data-level="1.6" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#basic-arithmetic"><i class="fa fa-check"></i><b>1.6</b> Basic Arithmetic</a></li>
<li class="chapter" data-level="1.7" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#using-functions-for-calculations"><i class="fa fa-check"></i><b>1.7</b> Using Functions for Calculations</a></li>
<li class="chapter" data-level="1.8" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#short-example"><i class="fa fa-check"></i><b>1.8</b> Short Example</a></li>
<li class="chapter" data-level="1.9" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#numeric-data"><i class="fa fa-check"></i><b>1.9</b> Numeric Data</a></li>
<li class="chapter" data-level="1.10" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#textcharacter-data"><i class="fa fa-check"></i><b>1.10</b> Text/Character Data</a></li>
<li class="chapter" data-level="1.11" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#logical-data"><i class="fa fa-check"></i><b>1.11</b> Logical Data</a><ul>
<li class="chapter" data-level="1.11.1" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#exercise"><i class="fa fa-check"></i><b>1.11.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#factors"><i class="fa fa-check"></i><b>1.12</b> Factors</a><ul>
<li class="chapter" data-level="1.12.1" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#exercise-1"><i class="fa fa-check"></i><b>1.12.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.13" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#practical-example"><i class="fa fa-check"></i><b>1.13</b> Practical Example</a></li>
<li class="chapter" data-level="1.14" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#subsetting-dataframes"><i class="fa fa-check"></i><b>1.14</b> Subsetting Dataframes</a><ul>
<li class="chapter" data-level="1.14.1" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#replacing-values-nas"><i class="fa fa-check"></i><b>1.14.1</b> Replacing Values &amp; NAs</a></li>
</ul></li>
<li class="chapter" data-level="1.15" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#indexing-data-frames"><i class="fa fa-check"></i><b>1.15</b> Indexing Data Frames</a></li>
<li class="chapter" data-level="1.16" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#data-cleaning"><i class="fa fa-check"></i><b>1.16</b> Data Cleaning</a></li>
<li class="chapter" data-level="1.17" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#simple-plots"><i class="fa fa-check"></i><b>1.17</b> Simple Plots</a><ul>
<li class="chapter" data-level="1.17.1" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#using-plot"><i class="fa fa-check"></i><b>1.17.1</b> Using <code>plot()</code></a></li>
</ul></li>
<li class="chapter" data-level="1.18" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#customising-plots"><i class="fa fa-check"></i><b>1.18</b> Customising Plots</a><ul>
<li class="chapter" data-level="1.18.1" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#labels"><i class="fa fa-check"></i><b>1.18.1</b> Labels</a></li>
<li class="chapter" data-level="1.18.2" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#plot-type"><i class="fa fa-check"></i><b>1.18.2</b> Plot Type</a></li>
<li class="chapter" data-level="1.18.3" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#other-customisable-features"><i class="fa fa-check"></i><b>1.18.3</b> Other Customisable Features</a></li>
<li class="chapter" data-level="1.18.4" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#change-axes"><i class="fa fa-check"></i><b>1.18.4</b> Change Axes</a></li>
</ul></li>
<li class="chapter" data-level="1.19" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#dont-panic"><i class="fa fa-check"></i><b>1.19</b> Don’t Panic!</a></li>
<li class="chapter" data-level="1.20" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#other-simple-plots"><i class="fa fa-check"></i><b>1.20</b> Other Simple Plots</a><ul>
<li class="chapter" data-level="1.20.1" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#histograms"><i class="fa fa-check"></i><b>1.20.1</b> Histograms</a></li>
<li class="chapter" data-level="1.20.2" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#boxplots"><i class="fa fa-check"></i><b>1.20.2</b> Boxplots</a></li>
<li class="chapter" data-level="1.20.3" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#scatterplots"><i class="fa fa-check"></i><b>1.20.3</b> Scatterplots</a></li>
</ul></li>
<li class="chapter" data-level="1.21" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#how-to-save-image-files"><i class="fa fa-check"></i><b>1.21</b> How to Save Image Files</a></li>
<li class="chapter" data-level="1.22" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>1.22</b> Plotting with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="1.22.1" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#ggplot"><i class="fa fa-check"></i><b>1.22.1</b> <code>ggplot()</code></a></li>
<li class="chapter" data-level="1.22.2" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#iris-example"><i class="fa fa-check"></i><b>1.22.2</b> Iris Example</a></li>
<li class="chapter" data-level="1.22.3" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#ggplot-with-our-mydata-file"><i class="fa fa-check"></i><b>1.22.3</b> <code>ggplot()</code> with our <code>mydata</code> file</a></li>
</ul></li>
<li class="chapter" data-level="1.23" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#bring-it-all-together"><i class="fa fa-check"></i><b>1.23</b> Bring It All Together</a></li>
<li class="chapter" data-level="1.24" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#write-out-files"><i class="fa fa-check"></i><b>1.24</b> Write Out Files</a></li>
<li class="chapter" data-level="1.25" data-path="getting-started-in-rstudio.html"><a href="getting-started-in-rstudio.html#questions"><i class="fa fa-check"></i><b>1.25</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html"><i class="fa fa-check"></i><b>2</b> Tests and modelling in R</a><ul>
<li class="chapter" data-level="2.1" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#hypothesis-testing"><i class="fa fa-check"></i><b>2.1</b> Hypothesis testing</a></li>
<li class="chapter" data-level="2.2" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#t-test"><i class="fa fa-check"></i><b>2.2</b> T test</a></li>
<li class="chapter" data-level="2.3" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#chi-squared-distribution-and-test"><i class="fa fa-check"></i><b>2.3</b> Chi squared distribution and test</a><ul>
<li class="chapter" data-level="2.3.1" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#contingency-tables"><i class="fa fa-check"></i><b>2.3.1</b> Contingency tables</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#chi-squared-distribution"><i class="fa fa-check"></i><b>2.4</b> Chi squared distribution</a></li>
<li class="chapter" data-level="2.5" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#one-way-anova"><i class="fa fa-check"></i><b>2.5</b> One way Anova</a></li>
<li class="chapter" data-level="2.6" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#sharks-and-ice-cream-example"><i class="fa fa-check"></i><b>2.6</b> Sharks and ice cream example</a></li>
<li class="chapter" data-level="2.7" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#simple-linear-regression-in-r"><i class="fa fa-check"></i><b>2.7</b> Simple Linear Regression in R</a></li>
<li class="chapter" data-level="2.8" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#regression-diagnostics---assess-the-validity-of-a-model"><i class="fa fa-check"></i><b>2.8</b> Regression Diagnostics - assess the validity of a model</a><ul>
<li class="chapter" data-level="2.8.1" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#violations-of-the-assumptions-available-treatments"><i class="fa fa-check"></i><b>2.8.1</b> Violations of the assumptions: available treatments</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#standardisation"><i class="fa fa-check"></i><b>2.9</b> Standardisation</a></li>
<li class="chapter" data-level="2.10" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#interaction-simple-slope-and-multiple-explanatory-factors"><i class="fa fa-check"></i><b>2.10</b> Interaction (simple slope) and multiple explanatory factors</a></li>
<li class="chapter" data-level="2.11" data-path="tests-and-modelling-in-r.html"><a href="tests-and-modelling-in-r.html#aic-bic"><i class="fa fa-check"></i><b>2.11</b> AIC &amp; BIC</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html"><i class="fa fa-check"></i><b>3</b> Simple Linear Model and Mixed Methods</a><ul>
<li class="chapter" data-level="3.1" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#data-sets-1"><i class="fa fa-check"></i><b>3.1</b> Data sets</a></li>
<li class="chapter" data-level="3.2" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#longitudinal-data"><i class="fa fa-check"></i><b>3.2</b> Longitudinal Data</a></li>
<li class="chapter" data-level="3.3" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#why-a-new-model"><i class="fa fa-check"></i><b>3.3</b> Why a new model?</a></li>
<li class="chapter" data-level="3.4" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#ecological-fallacy-quick-illustration---no-need-to-run"><i class="fa fa-check"></i><b>3.4</b> Ecological Fallacy (quick illustration) - no need to run</a></li>
<li class="chapter" data-level="3.5" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#simple-example"><i class="fa fa-check"></i><b>3.5</b> Simple Example</a></li>
<li class="chapter" data-level="3.6" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#now-for-advanced-model-set-up"><i class="fa fa-check"></i><b>3.6</b> Now for Advanced: Model set up</a><ul>
<li class="chapter" data-level="3.6.1" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#pooling"><i class="fa fa-check"></i><b>3.6.1</b> Pooling</a></li>
<li class="chapter" data-level="3.6.2" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#no-pooling"><i class="fa fa-check"></i><b>3.6.2</b> No pooling</a></li>
<li class="chapter" data-level="3.6.3" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#partial-pooling-varying-intercepts"><i class="fa fa-check"></i><b>3.6.3</b> Partial Pooling (varying intercepts)</a></li>
<li class="chapter" data-level="3.6.4" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#partial-pooling-extended---varying-intercepts-andor-slopes"><i class="fa fa-check"></i><b>3.6.4</b> Partial Pooling Extended - (varying intercepts and/or slopes)</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#multilevel-modelling-with-random-intercepts-and-slopes"><i class="fa fa-check"></i><b>3.7</b> Multilevel modelling with random intercepts and slopes</a><ul>
<li class="chapter" data-level="3.7.1" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#overview-of-the-data-set"><i class="fa fa-check"></i><b>3.7.1</b> Overview of the data set</a></li>
<li class="chapter" data-level="3.7.2" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#prepare"><i class="fa fa-check"></i><b>3.7.2</b> Prepare</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#random-slopes-intercepts-and-cross-level-interactions-optional"><i class="fa fa-check"></i><b>3.8</b> Random slopes, intercepts and cross level interactions (optional)</a></li>
<li class="chapter" data-level="3.9" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#simple-example-1"><i class="fa fa-check"></i><b>3.9</b> Simple Example</a><ul>
<li class="chapter" data-level="3.9.1" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#optional-odds-refresher"><i class="fa fa-check"></i><b>3.9.1</b> Optional (Odds Refresher)</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="simple-linear-model-and-mixed-methods.html"><a href="simple-linear-model-and-mixed-methods.html#data-description"><i class="fa fa-check"></i><b>3.10</b> Data Description</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html"><i class="fa fa-check"></i><b>4</b> Introduction to Bayesian Estimation</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#intro-to-bayesian-estimation"><i class="fa fa-check"></i><b>4.1</b> Intro to Bayesian estimation</a><ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#data-sets-2"><i class="fa fa-check"></i><b>4.1.1</b> Data sets</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#bayes-inference-and-one-sample-t-test"><i class="fa fa-check"></i><b>4.2</b> Bayes inference and one-sample t-test</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#difference-between-two-groups-means"><i class="fa fa-check"></i><b>4.3</b> Difference between two groups’ means</a></li>
<li class="chapter" data-level="4.4" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#bayes-factor-example"><i class="fa fa-check"></i><b>4.4</b> Bayes Factor Example</a></li>
<li class="chapter" data-level="4.5" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#bayes-factor-and-anova"><i class="fa fa-check"></i><b>4.5</b> Bayes Factor and Anova</a><ul>
<li class="chapter" data-level="4.5.1" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#exercise-2"><i class="fa fa-check"></i><b>4.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#linear-models-with-bas"><i class="fa fa-check"></i><b>4.6</b> Linear models with BAS</a><ul>
<li class="chapter" data-level="4.6.1" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#bic-and-r-squared"><i class="fa fa-check"></i><b>4.6.1</b> BIC and R squared</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#predictions-from-bas.lm"><i class="fa fa-check"></i><b>4.7</b> Predictions from bas.lm</a></li>
<li class="chapter" data-level="4.8" data-path="introduction-to-bayesian-estimation.html"><a href="introduction-to-bayesian-estimation.html#examining-and-presenting-results"><i class="fa fa-check"></i><b>4.8</b> Examining and presenting results</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayesian-mixed-methods-example.html"><a href="bayesian-mixed-methods-example.html"><i class="fa fa-check"></i><b>5</b> Bayesian Mixed methods example</a><ul>
<li class="chapter" data-level="5.1" data-path="bayesian-mixed-methods-example.html"><a href="bayesian-mixed-methods-example.html#data-description-1"><i class="fa fa-check"></i><b>5.1</b> Data Description</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="diy.html"><a href="diy.html"><i class="fa fa-check"></i><b>6</b> DIY</a><ul>
<li class="chapter" data-level="6.1" data-path="diy.html"><a href="diy.html#extra-resources-to-check"><i class="fa fa-check"></i><b>6.1</b> Extra Resources to check</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="extra-resources.html"><a href="extra-resources.html"><i class="fa fa-check"></i><b>7</b> Extra Resources</a><ul>
<li class="chapter" data-level="7.1" data-path="extra-resources.html"><a href="extra-resources.html#more-r-practice"><i class="fa fa-check"></i><b>7.1</b> More R practice</a></li>
<li class="chapter" data-level="7.2" data-path="extra-resources.html"><a href="extra-resources.html#data-cleaning-1"><i class="fa fa-check"></i><b>7.2</b> Data Cleaning</a></li>
<li class="chapter" data-level="7.3" data-path="extra-resources.html"><a href="extra-resources.html#visualisations"><i class="fa fa-check"></i><b>7.3</b> Visualisations</a></li>
<li class="chapter" data-level="7.4" data-path="extra-resources.html"><a href="extra-resources.html#other-common-methods-in-r"><i class="fa fa-check"></i><b>7.4</b> Other Common Methods in R</a></li>
<li class="chapter" data-level="7.5" data-path="extra-resources.html"><a href="extra-resources.html#big-data"><i class="fa fa-check"></i><b>7.5</b> Big Data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PPLS PhD Training Workshop: Statistics and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-mixed-methods-example" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Bayesian Mixed methods example</h1>
<p>We will illustrate two examples here that you have already seen in Chapter 3. We will compare results we obtain from Bayesian alternative to lmer (bmer) and to glmer (brm). We may not have time to cover all, but please do have a look at your own time. We will provde an introduction to the main steps. You will see that estimation itself takes no time at all but you will need to explore your outputs a bit more, given the variety of the specifications you are presented with in Bayesian settings.</p>
<div id="data-description-1" class="section level2">
<h2><span class="header-section-number">5.1</span> Data Description</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Lets load the data</span>
lung_cancer &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;lung_cancer.csv&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Check out the structure</span>
<span class="kw">str</span>(lung_cancer)</code></pre>
<pre><code>## &#39;data.frame&#39;:    8525 obs. of  28 variables:
##  $ X           : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ tumorsize   : num  68 64.7 51.6 86.4 53.4 ...
##  $ co2         : num  1.53 1.68 1.53 1.45 1.57 ...
##  $ pain        : int  4 2 6 3 3 4 3 3 4 5 ...
##  $ wound       : int  4 3 3 3 4 5 4 3 4 4 ...
##  $ mobility    : int  2 2 2 2 2 2 2 3 3 3 ...
##  $ ntumors     : int  0 0 0 0 0 0 0 0 2 0 ...
##  $ nmorphine   : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ remission   : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ lungcapacity: num  0.801 0.326 0.565 0.848 0.886 ...
##  $ Age         : num  65 53.9 53.3 41.4 46.8 ...
##  $ Married     : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 2 1 1 2 2 1 2 1 ...
##  $ FamilyHx    : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 1 2 1 ...
##  $ SmokingHx   : Factor w/ 3 levels &quot;current&quot;,&quot;former&quot;,..: 2 2 3 2 3 3 1 2 2 3 ...
##  $ Sex         : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 2 1 1 2 2 2 1 2 2 2 ...
##  $ CancerStage : Factor w/ 4 levels &quot;I&quot;,&quot;II&quot;,&quot;III&quot;,..: 2 2 2 1 2 1 2 2 2 2 ...
##  $ LengthofStay: int  6 6 5 5 6 5 4 5 6 7 ...
##  $ WBC         : num  6088 6700 6043 7163 6443 ...
##  $ RBC         : num  4.87 4.68 5.01 5.27 4.98 ...
##  $ BMI         : num  24.1 29.4 29.5 21.6 29.8 ...
##  $ IL6         : num  3.7 2.63 13.9 3.01 3.89 ...
##  $ CRP         : num  8.086 0.803 4.034 2.126 1.349 ...
##  $ DID         : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ Experience  : int  25 25 25 25 25 25 25 25 25 25 ...
##  $ School      : Factor w/ 2 levels &quot;average&quot;,&quot;top&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Lawsuits    : int  3 3 3 3 3 3 3 3 3 3 ...
##  $ HID         : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ Medicaid    : num  0.606 0.606 0.606 0.606 0.606 ...</code></pre>
<p>Fit the model using a mixture of variables that theoretically are important here:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lme4)
<span class="co"># Estimate the model and store results in model_lc</span>
model_lc &lt;-<span class="st"> </span><span class="kw">glmer</span>(remission <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>LengthofStay <span class="op">+</span><span class="st"> </span>FamilyHx <span class="op">+</span><span class="st"> </span>CancerStage <span class="op">+</span><span class="st">  </span>CancerStage <span class="op">+</span><span class="st"> </span>Experience <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>DID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>HID),
                  <span class="dt">data =</span> lung_cancer, <span class="dt">family =</span> binomial, <span class="dt">optimizer=</span><span class="st">&#39;Nelder_Mead&#39;</span>) <span class="co">#note that I have updated the optimizer (to avoid warnings)</span></code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl =
## control$checkConv, : Model failed to converge with max|grad| = 0.858202
## (tol = 0.001, component 1)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Print the mod results:what do you find?</span>
<span class="kw">summary</span>(model_lc)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: 
## remission ~ Age + LengthofStay + FamilyHx + CancerStage + CancerStage +  
##     Experience + (1 | DID) + (1 | HID)
##    Data: lung_cancer
## 
##      AIC      BIC   logLik deviance df.resid 
##   7225.6   7296.1  -3602.8   7205.6     8515 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.9563 -0.4229 -0.1890  0.3629  8.2299 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  DID    (Intercept) 3.8471   1.9614  
##  HID    (Intercept) 0.2419   0.4919  
## Number of obs: 8525, groups:  DID, 407; HID, 35
## 
## Fixed effects:
##                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -1.960353   0.568451  -3.449 0.000564 ***
## Age            -0.015968   0.005904  -2.705 0.006836 ** 
## LengthofStay   -0.043030   0.035505  -1.212 0.225524    
## FamilyHxyes    -1.295706   0.093369 -13.877  &lt; 2e-16 ***
## CancerStageII  -0.321924   0.076376  -4.215 2.50e-05 ***
## CancerStageIII -0.857475   0.100025  -8.573  &lt; 2e-16 ***
## CancerStageIV  -2.137657   0.162281 -13.173  &lt; 2e-16 ***
## Experience      0.125360   0.026881   4.664 3.11e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) Age    LngthS FmlyHx CncSII CnSIII CncSIV
## Age         -0.390                                          
## LengthofSty -0.141 -0.319                                   
## FamilyHxyes -0.013  0.103 -0.112                            
## CancerStgII  0.084 -0.181 -0.186 -0.052                     
## CancrStgIII  0.139 -0.222 -0.239 -0.051  0.513              
## CancerStgIV  0.148 -0.220 -0.194 -0.012  0.357  0.347       
## Experience  -0.835 -0.009 -0.004 -0.022 -0.002 -0.005 -0.012
## convergence code: 0
## Model failed to converge with max|grad| = 0.858202 (tol = 0.001, component 1)</code></pre>
<p>Lets also build CIs while we are here - we can compare those later to Credible Intervals from brm.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lme4)
se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">vcov</span>(model_lc))) <span class="co">#standard errors</span>
<span class="co"># table of estimates with 95% CI using errors we obtained above</span>
(CI_estimates &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">Est =</span> <span class="kw">fixef</span>(model_lc), <span class="dt">LL =</span> <span class="kw">fixef</span>(model_lc) <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se, <span class="dt">UL =</span> <span class="kw">fixef</span>(model_lc) <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span>
<span class="st">    </span>se))</code></pre>
<pre><code>##                        Est          LL           UL
## (Intercept)    -1.96035276 -3.07451662 -0.846188910
## Age            -0.01596794 -0.02753911 -0.004396764
## LengthofStay   -0.04303048 -0.11261951  0.026558540
## FamilyHxyes    -1.29570603 -1.47870949 -1.112702564
## CancerStageII  -0.32192409 -0.47162068 -0.172227491
## CancerStageIII -0.85747504 -1.05352351 -0.661426574
## CancerStageIV  -2.13765689 -2.45572684 -1.819586939
## Experience      0.12536019  0.07267364  0.178046738</code></pre>
<p>We have seen these ones before. Lets us now see what happens if were to move into Bayesian setting:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(brms)</code></pre>
<pre><code>## Loading required package: Rcpp</code></pre>
<pre><code>## Loading &#39;brms&#39; package (version 2.8.0). Useful instructions
## can be found by typing help(&#39;brms&#39;). A more detailed introduction
## to the package is available through vignette(&#39;brms_overview&#39;).</code></pre>
<pre><code>## 
## Attaching package: &#39;brms&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cs</code></pre>
<pre><code>## The following object is masked from &#39;package:MuMIn&#39;:
## 
##     loo</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     ngrps</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">mod =<span class="st"> </span>brms<span class="op">::</span><span class="kw">brm</span>(remission <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>LengthofStay <span class="op">+</span><span class="st"> </span>FamilyHx <span class="op">+</span><span class="st"> </span>CancerStage <span class="op">+</span><span class="st">  </span>CancerStage <span class="op">+</span><span class="st"> </span>Experience <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>DID)
                <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>HID),
                  <span class="dt">data =</span> lung_cancer,
<span class="dt">family =</span> <span class="st">&#39;bernoulli&#39;</span>,
<span class="dt">prior =</span> <span class="kw">set_prior</span>(<span class="st">&#39;normal(0, 3)&#39;</span>), <span class="dt">iter =</span> <span class="dv">2000</span>,
<span class="dt">chains =</span> <span class="dv">4</span>,
<span class="dt">cores =</span> <span class="dv">4</span>
)</code></pre>
<pre><code>## Compiling the C++ model</code></pre>
<pre><code>## Start sampling</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mod)</code></pre>
<pre><code>##  Family: bernoulli 
##   Links: mu = logit 
## Formula: remission ~ Age + LengthofStay + FamilyHx + CancerStage + CancerStage + Experience + (1 | DID) + (1 | HID) 
##    Data: lung_cancer (Number of observations: 8525) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Group-Level Effects: 
## ~DID (Number of levels: 407) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     2.02      0.11     1.82     2.24        895 1.00
## 
## ~HID (Number of levels: 35) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.51      0.20     0.06     0.89        115 1.02
## 
## Population-Level Effects: 
##                Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept         -1.97      0.59    -3.15    -0.85        896 1.01
## Age               -0.02      0.01    -0.03    -0.00       5745 1.00
## LengthofStay      -0.04      0.04    -0.11     0.03       5114 1.00
## FamilyHxyes       -1.30      0.10    -1.49    -1.12       5575 1.00
## CancerStageII     -0.32      0.08    -0.47    -0.17       4420 1.00
## CancerStageIII    -0.86      0.10    -1.06    -0.66       3722 1.00
## CancerStageIV     -2.14      0.16    -2.46    -1.84       4305 1.00
## Experience         0.13      0.03     0.07     0.18        659 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Various plots are available :plot either all </span>
<span class="kw">plot</span>(mod, <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-56-1.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-56-2.png" width="672" /></p>
<p>If you compare the resulting plots to those that we found last time using glmer() you ll be surprised to find out how some CIs have changed once we are in a Bayesian setting.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Can also check ME</span>
brms<span class="op">::</span><span class="kw">marginal_effects</span>(mod, <span class="dt">ask =</span> <span class="ot">FALSE</span>)</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-57-1.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-57-2.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-57-3.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-57-4.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-57-5.png" width="672" /></p>
<p>You will note that at overall, the results are quite similar when it comes to coefficients. However, we may find that our uncertainty is estimated with more information in mind here. If you have faith in Bayesian thinking, then consequently you will have more faith in the above results or vice versa :)</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-bayesian-estimation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="diy.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-bayes.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
