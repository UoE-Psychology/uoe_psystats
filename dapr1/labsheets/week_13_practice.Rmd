# A: Walkthrough

```{r message = FALSE}
library(tidyverse)
library(moderndive)
```

```{r}
outcomes <- tibble(vals = factor(c('S', 'F')))
outcomes
```

```{r}
prob <- c(1/5, 4/5)
samples <- rep_sample_n(outcomes, size = 98, replace = TRUE, reps = 1000, prob = prob)
samples
```

```{r}
sample_props <- samples %>% 
    group_by(replicate) %>%
    summarise(prop = sum(vals == 'S') / n())

sample_props
```

```{r}
ggplot(sample_props, aes(x = prop)) +
    geom_dotplot(binwidth = 0.01, dotsize = 0.5, fill = 'white', stackratio = 0.5) +
    labs(x = expression(hat(p)))
```

```{r}
ggplot(sample_props, aes(x = prop)) +
    geom_dotplot(binwidth = 0.01, dotsize = 0.5, fill = 'white', stackratio = 0.5) +
    geom_vline(xintercept = 0.26, color = 'red', size = 1) +
    labs(x = expression(hat(p)))
```


```{r}
ggplot(sample_props, aes(x = prop, fill = (prop >= 0.26))) +
    geom_dotplot(binwidth = 0.01, dotsize = 0.5, stackratio = 0.5) +
    labs(x = expression(hat(p)), fill = expression(hat(p) >= 0.26)) +
    theme(legend.position="top")
```

```{r}
pvalue <- sample_props %>%
    summarise(pvalue = sum(prop > 0.26) / n())

pvalue
```

```{r}
sample_props %>%
    summarise(sd = sd(prop))
```


# B: Lab

Before attempting to answer the following questions, make sure to run the following code chunk, which assumes that you have already installed the packages `tidyverse` and `moderndive`.
If you have not installed them yet, type `install.packages("tidyverse")` and `install.packages("moderndive")` in the R console.

Load the `tidyverse` and `moderndive` packages:
```{r message = FALSE}
library(tidyverse)
library(moderndive)
```

Let's start by loading the data using the function `read_tsv` to read tab separated values:
```{r message=FALSE}
bodytemp <- read_tsv('https://edin.ac/2vkjSaw')
bodytemp
```

## Question 1

1. What are the names of the variables in the dataset?
2. What are the dimensions of the tibble?
3. Are there any missing values? _**Hint:** Use the function `anyNA()` to check if there are any Not Available (NA) entries._

**Solution:**

1. ...
2. ...
3. ...

## Question 2

What is the average temperature in the sample and the standard deviation?

**Solution:**

```{r}

```


## Question 3

State the null and alternative hypothesis for the research question of this lab.

**Solution:**


## Question 4

Compute the bootstrap distribution of the mean using 10,000 repeated samples.

Plot the bootstrap distribution using a histogram.

**Solution:**

```{r}

```


## Question 5

Compute the null distribution, which needs to be centred at the value of the parameter specified by the null hypothesis.

Plot the null distribution using a histogram.

_**Hint**: Since you already have the bootstrap distribution, which is centred at the sample mean, you can shift the original sample by adding to each body temperature the difference between the parameter value in the null hypothesis and the sample mean._

**Solution:**

```{r}

```


## Question 6

Show a histogram of the null distribution, superimposing a vertical red line displaying the observed statistic.

**Solution:**

```{r}

```


## Question 7

Calculate the proportion of means as extreme as the observed statistic in the null distribution.

_**Hint:** As this is a double-sided alternative hypothesis, remember to use 2 * p-value of the smallest tail._

**Solution:**

```{r}

```


## Question 8

Using the p-value found in the previous question, how would you answer the research question of the lab?

**Solution:**

...

