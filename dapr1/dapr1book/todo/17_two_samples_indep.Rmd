```{r, echo=FALSE}
HIDDEN_SOLS=FALSE
TOGGLE=TRUE
set.seed(15732)
ggplot2::theme_set(ggplot2::theme_gray(base_size=13))
```

# Comparing two means (independent samples) {#two-indep-samples}


<div class="lo">
#### Instructions {-}
  
  - In this two-hour lab we will go through worked examples in the first hour, and you will attempt to answer some questions in the second hour.
- The Rmarkdown file for this week is [here](https://uoe-psychology.github.io/uoe_psystats/dapr1/labsheets/week_15_practice.Rmd).


#### Learning outcomes {-}

**LO1.** Understand how to perform a two-sample t-test and interpret the results.

**LO2.** Understand how to calculate a two-sample t-interval and interpret the results.

**LO3.** Being able to check the technical conditions for applying the t-procedures.
</div>


## Recap

Last week you explored how to draw conclusions about population parameters on the basis of sample statistics.
In particular, given a random sample of size $n$ from a population, you tested if the population mean was equal to some hypothesized value.

Let the sample mean be $\bar{x}$. We test if the sample was taken from a population with mean $\mu_0$ by comparing the observed $t$-statistic
<center>
$$
t = \frac{\bar{x} - \mu_0}{s/\sqrt{n}}
$$
</center>
with:

- __for one-sided hypotheses__, the critical value of level $\alpha$ from a $t$-distribution with $n-1$ degrees of freedom
<center>
$$
t^*_\textrm{df} = \texttt{qt(p = 1 - alpha, df = n-1)}
$$
</center>

- __for two-sided hypotheses__, the critical value of level $\frac{\alpha}{2}$ from a $t$-distribution with $n-1$ degrees of freedom
<center>
$$
t^*_\textrm{df} = \texttt{qt(p = 1 - alpha/2, df = n-1)}
$$
</center>

We reject the null hypothesis if the observed $t$-statistic is, __in absolute value__, as extreme or more extreme than the critical value:

<center>
__Reject $H_0$ if__ $|t| \geq t^*_\textrm{df}$
</center>
<br>

The above procedure applies when testing a single parameter (a proportion or a mean) from a single population.

Today you will explore and apply inference procedures for comparing parameters between two populations or treatment groups.


## Key terminology

<div class="def">
#### Units and variables {-}

The individual entities on which data are collected are called __observational units__.

The number of observational units in the study is known as the __sample size__, as is typically denoted by $n$.

A __variable__ is any characteristic that varies from observational unit to observational unit.


#### Categorical and quantitative variables {-}

Variables are either __categorical__ or __quantitative__:

- A __categorical variable__ divides the units into groups, placing each unit into exactly one of two or more categories. 
_Technology typ: In R, a categorical variable should be a `factor`._

- A __quantitative variable__ measures a numerical quantity for each case.
Numerical operations like adding and averaging make sense only for quantitative variables.

A special kind of categorical variable is a __binary variable__, for which only two possible categories exist.

_Note: One simple way to distinguish between categorical and quantitative variables is to ask yourself if it makes sense to take an average of the values._


#### Explanatory and response variables {-}

If we are using one variable to help us understand or predict values of another variable, we call the former the __explanatory variable__ and the latter the __response variable__.


#### Observational studies vs randomized experiments {-}

An __observational study__ is a study in which the researcher does manipulate the value of any variable, but simply observes the values as they naturally	exist.

A __randomized experiment__ is a study in which the researcher determines __at random__ the explanatory variable for each unit, before the response variable is measured.


<!-- #### Long vs wide data format {-} -->

<!-- Data are in **long** format if each column represents a different variable (e.g., year, sex or assigned task). -->

<!-- Data are in **wide** format if each column represents a different group (e.g., task 1 and task 2). -->
</div>


## Walkthrough: Got a friend?

In today's in-class activity we will use data from the General Social Survey conducted in the US in 2004.
One of the questions asked to a random sample of adult Americans in the 2004 General Social Survey (GSS) was:

> "From time to time, most people discuss important matters with other people. Looking back over the last six months --- who are the people with whom you discussed matters important to you? Just tell me their first names or initials."

The interviewer was asked to record how many names were mentioned, along with the person's sex.

How many names would you mention if you had to answer this question?
How do you expect the responses to differ between men and women? Do you expect women to mention more names than men, or vice-versa, or perhaps the number of names to be similar between men and women?

In today's lab, you will explore whether men and women differ with regard to the number of names they tend to mention.
For simplicity, we will refer to the people with whom you talk about important personal matters as "close friends".

The survey data are stored in the file [`close_friends.txt`](https://raw.githubusercontent.com/UoE-Psychology/uoe_psystats/master/dapr1/dapr1book/data/close_friends.txt).

Before learning a new test procedure to assess a potential difference in the centre of a quantitative variable between two independent groups, it is good practice to display, explore and summarise the data.

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 1")`
Identify the observational units in this study.
`r msmbstyle::question_end()`


`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
The observational units are the sampled adult Americans taking part in the 2004 General Social Survey (GSS).
`r msmbstyle::solution_end()`

---


`r msmbstyle::question_begin(header = "&#x25BA; Question 2")`
- Identify the recorded variables in this study.
- Classify each variabile either as categorical (also binary) or quantitative.
- Identify each variable's role: explanatory or response.


| Variable's name | Type             | Role             |
|:----------------|:----------------:|:----------------:|
| ?               | ?                | ?                |
| ?               | ?                | ?                |


`r msmbstyle::question_end()`


`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
The recorded variables are the sex of the participant and the number of names given by the participant. 
The former is categorical and binary^[**Note**: The extensive and open-source data from this specific survey, which was conducted in the US in the year 2004, only has two observed values in the column sex: female and male. 
As the data recorded by the US officials present only two categories in the column sex, in this data the variable sex is categorical and binary.], while the latter is a numerical value that varies from participant to participant. 
We are interested in how the number of mentioned names tends to vary with the sex of the participant. 
For this reason, sex is the explanatory variable, while number of close friends in the response variable.

| Variable's name         | Type                        | Role             |
|:------------------------|:---------------------------:|:----------------:|
| Sex                     | Categorical and binary      | Explanatory      |
| Number of close friends | Quantitative                | Response         |

`r msmbstyle::solution_end()`


---


`r msmbstyle::question_begin(header = "&#x25BA; Question 3")`
Did the study make use of random assignment, random sampling, both or neither?
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
This study only involved random sampling of observational units from the population of adult Americans in 2004.
`r msmbstyle::solution_end()`

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 4")`
Is this an observational study or an experiment? Explain why.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
This is an observational study as the researchers limited themselves to record the observed values that naturally occur.
The researchers did not perform any manipulation of the variables, such as random assignment of observational units to groups. If this were the case, we would be analysing data from a randomised experiment.
`r msmbstyle::solution_end()`


---

`r msmbstyle::question_begin(header = "&#x25BA; Question 5")`
State, in words, the null and alternative hypotheses to test whether the sample data provide evidence that American males and females tend to differ with regard to the average number of close friends they mention.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
The null hypothesis is that the population mean number of close friends is the same for adult American males as for females.
In other words, the null hypothesis states that there is no difference in the population mean number of close friends between males and females.

The alternative hypothesis is that the population mean number of close friends is not the same for males as for females. 
In other words, the alternative hypothesis states that there is a difference in the population mean number of close friends between males and females.
`r msmbstyle::solution_end()`

---


`r msmbstyle::question_begin(header = "&#x25BA; Question 6")`
Define the parameters of interest in this study, and identify appropriate symbols for them.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
- $\mu_f$: population mean number of close friends mentioned by adult American females
- $\mu_m$: population mean number of close friends mentioned by adult American males
`r msmbstyle::solution_end()`

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 7")`
State the null and alternative hypotheses in symbols.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
$$
H_0 : \mu_f = \mu_m      \qquad \textrm{OR} \qquad     H_0 : \mu_f - \mu_m = 0\\
H_1 : \mu_f \neq \mu_m   \qquad \textrm{OR} \qquad     H_1 : \mu_f - \mu_m \neq 0
$$
`r msmbstyle::solution_end()`

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 8")`
Explain why the one-sample t-test is not appropriate to answer the research question of this study.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
The one-sample t-test introduced in [Week 16](#todo) tests if the population that the observed sample came from has a hypothesized mean.
Here, instead, we want to compare the means of two populations (or, if it were a randomized experiment, between two treatment groups).
`r msmbstyle::solution_end()`


---


`r msmbstyle::question_begin(header = "&#x25BA; Question 9")`
Load the data into R and inspect it. 

Pay particular attention to:

- the variable names;
- the dimensions of the tibble;
- the format of the data (i.e., make sure that variables are correctly encoded)
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
```{r, message=FALSE}
library(tidyverse)

gss <- read_tsv('https://edin.ac/2vQrCBi', col_names = TRUE)
```

Inspect the names of the variables and the first six rows
```{r}
head(gss)
```

Check the number of observational units and variables
```{r}
dim(gss)
```

The tibble says that Sex is of class `chr`, character. As Sex is a categorical variable, we will encode it as a factor:
```{r}
gss <- gss %>%
  mutate(Sex = factor(Sex))

# check encoding
head(gss)
```
`r msmbstyle::solution_end()`


<!-- <div class="def"> -->
<!-- #### Long vs wide format {-} -->

<!-- Data are in **long** format if each column represents a different variable (e.g., year, sex or assigned task) and they are in **wide** format if each column represents a different group (e.g., task 1 and task 2). -->
<!-- </div> -->

<!-- `r msmbstyle::question_begin()` -->
<!-- Are the data in wide or long format? -->
<!-- `r msmbstyle::question_end()` -->


<!-- We will now convert the data from wide to long format. -->

<!-- The relevant function is: -->
<!-- ``` -->
<!-- pivot_longer(DATA NAME,  -->
<!--              GROUP COLUMNS,  -->
<!--              names_to = "NAME OF COLUMN REPRESENTING GROUPS",  -->
<!--              values_to = "NAME OF VALUES COLUMN") -->
<!-- ``` -->

<!-- ```{r} -->
<!-- gss_data <- pivot_longer(gss,  -->
<!--                          1:2, -->
<!--                          names_to = 'sex', -->
<!--                          values_to = 'number_close_friends') -->
<!-- head(gss_data) -->

<!-- gss_data <- gss_data %>% -->
<!--   mutate(sex = str_replace(sex, 'CloseFriendsMen', 'male'), -->
<!--          sex = str_replace(sex, 'CloseFriendsWomen', 'female')) -->
<!-- head(gss_data) -->
<!-- ``` -->


---

`r msmbstyle::question_begin(header = "&#x25BA; Question 10")`
Summarise the survey responses by showing the counts of the number of close friends by sex.

Try sketching by hand histograms showing, for each sex, the frequency of each reported number of close friends.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
Create a two-way frequency table of the participants' responses by sex:
```{r}
tally <- xtabs(~ Sex + NumberCloseFriends, data = gss)
tally
```

Add the totals for each sex:
```{r}
tally <- addmargins(tally, margin = 2)
tally
```

Here, `margin = 1` calculates the totals over the rows, while `margin = 2` calculates the totals over the columns.
`r msmbstyle::solution_end()`

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 11")`
Report a table of descriptive summaries by sex.

Report the sample size, mean, SD, minimum, lower quartile, median, upper quartile, and maximum for each sex.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
When comparing a quantitative response variable between two independent groups, encoded in a categorical variable, we could report:

- sample size
- mean
- SD
- minimum
- lower quartile
- median
- upper quartile
- maximum

The median is the value such that 50% of the data lies below and 50% of the data lies above that value.

The median cuts the data into two parts: part to the left of the median and part to the right of the median. 
The median of left part is known as the lower quartile, and represents the value for which 25% of the data lie below that value.
The median of right part is known as the upper quartile, and represents the value for which 25% of the data lie above that value.

The interquartile range (IQR) is simply the difference between the upper quartile and the lower quartile, and represents the width of the interval containing the middle 50% of all observations.

The minimum, lower quartile, median, upper quartile, and maximum jointly form the so-called __five-number summary__ of the distribution of a quantitative variable.

```{r}
descr_stats <- gss %>%
  group_by(Sex) %>%
  summarise(
    SampleSize = n(),
    Mean = mean(NumberCloseFriends),
    SD = sd(NumberCloseFriends), 
    Minimum = min(NumberCloseFriends),
    LowerQuartile = quantile(NumberCloseFriends, p = 0.25),
    Median = median(NumberCloseFriends),
    UpperQuartile = quantile(NumberCloseFriends, p = 0.75),
    Maximum = max(NumberCloseFriends)
  )
descr_stats
```

You can use the function `kable` to nicely format the above table compute above for HTML webpages: 
```{r echo=FALSE}
knitr::kable(descr_stats, digits = 2) %>% 
  kableExtra::kable_styling(font_size = 12)
```

`r msmbstyle::solution_end()`

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 12")`
Are the descriptive summaries from the previous question parameters or statistics? Explain why.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
The values in the above table are statistics. They are numerical quantities computed on observational units which represent a random sample from the population of adult Americans in 2004.
`r msmbstyle::solution_end()`

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 13")`
Produce a visual display of your summary statistics.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
A visual display of the five-number summary is given by the boxplot. This is typicall a very good visualisation when your data involve a quantitative response variable and a categorical explanatory variable.

```{r}
ggplot(gss, aes(x = Sex, y = NumberCloseFriends)) +
  geom_boxplot(color = 'darkorange') +
  theme_classic() +
  coord_flip()
```
`r msmbstyle::solution_end()`

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 14")`
Visualise the distribution of the number of close friends by sex.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
Separate plots:
```{r, fig.heigh = 5, fig.width = 9, fig.align='center'}
ggplot(gss, aes(x = NumberCloseFriends, fill = Sex)) +
  geom_histogram(binwidth = 1, color = 'white') +
  facet_grid(cols = vars(Sex))
```

Proportions:
```{r}
ggplot(gss, aes(x = NumberCloseFriends, fill = Sex)) +
  geom_histogram(binwidth = 1, color = 'white', position = 'fill') +
  labs(y = 'proportion')
```
`r msmbstyle::solution_end()`

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 15")`
Comment on what the histograms reveal about the shapes of the distributions.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
The distribution of number of close friends for both males and females appears to be skewed to the right.

The variability in the number of mentioned names seems to be similar across males and females.

The sample mean number of mentioned names seems to be slightly higher for females than males.
`r msmbstyle::solution_end()`

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 16")`
Report the sample mean and sample standard deviation of the number of close friends for each sex using appropriate symbols.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
The sample mean number of close friends for females is $\bar{x}_f$ = `r descr_stats %>% filter(Sex == 'female') %>% select(Mean) %>% pull() %>% round(2)`, with standard deviation $s_f$ = `r descr_stats %>% filter(Sex == 'female') %>% select(SD) %>% pull() %>% round(2)` friends.

For males, the sample mean number of close friends is $\bar{x}_m$ = `r descr_stats %>% filter(Sex == 'male') %>% select(Mean) %>% pull() %>% round(2)`, with standard deviation $s_m$ = `r descr_stats %>% filter(Sex == 'male') %>% select(SD) %>% pull() %>% round(2)` friends.
`r msmbstyle::solution_end()`

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 17")`
Compute the difference in the sample mean number of close friends for females and males.

Do you think it could be possible to obtain sample means this far apart even if the population means were actually equal? Explain why.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`

The difference in sample means is $\bar{x}_f - \bar{x}_m$ = `r (descr_stats %>% filter(Sex == 'female') %>% select(Mean) %>% pull() - descr_stats %>% filter(Sex == 'male') %>% select(Mean) %>% pull()) %>% round(2)`.
`r msmbstyle::solution_end()`

---

Because of sampling variability, we can not conclude that, because simply the sample means differ, the means of the two populations must differ too.

We must resort to a principled framework to test this, and we have already learned to use statistical hypothesis testing in order to assess if sample results (in our case, the observed difference in sample mean number of close friends) are significant in the sense of being unlikely to have occurred by chance (from random sampling) alone.

__Estimating the magnitude of the difference in population means.__

How can we estimate the magnitude of the difference in population means? By using a confidence interval for the difference in means!

---

<div class="red">
#### Comparing the means of two independent groups {-}

_Suppose you wish to test for the significance of the difference between two population means denoted $\mu_1$ and $\mu_2$ and, if the difference is signficant, you wish to quantify the magnitude of the difference using a confidence interval._

##### Test of significance  {-}

Null hypothesis: $H_0: \mu_1 = \mu_2$ $\quad$ or $\quad$ $H_0: \mu_1 - \mu_2 = 0$

Alternative hypothesis:

i. $H_1: \mu_1 < \mu_2$ $\quad$ or $\quad$ $H_1: \mu_1 - \mu_2 < 0$
ii. $H_1: \mu_1 > \mu_2$ $\quad$ or $\quad$ $H_1: \mu_1 - \mu_2 > 0$
iii. $H_1: \mu_1 \neq \mu_2$ $\quad$ or $\quad$ $H_1: \mu_1 - \mu_2 \neq 0$


Test statistic:
<center>
$$
t = \frac{(\bar x_1 - \bar x_2) - 0}{SE(\bar x_1 - \bar x_2)}
$$
</center>


$p$-value:

i. $\mathrm{Pr}(T_{df} \leq t)$
ii. $\mathrm{Pr}(T_{df} \geq t)$
iii. $2 \times \mathrm{Pr}(T_{df} \leq |t|)$

where $T_{df}$ denotes a $t$-distribution with $df$ degrees of freedom.


SE and df:

1. Population variances unknown and not equal:
  + Very difficult degrees of freedom, let R calculate them
  + Standard error of the difference in means
<center>
$$
SE(\bar x_1 - \bar x_2) = \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}
$$
</center>

2. Population variances unknown and equal:
  + Degrees of freedom $df = n_1 + n_2 - 2$
  + Standard error of the difference in means
<center>
$$
SE(\bar x_1 - \bar x_2) = s_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}} \\ 
s_p = \sqrt{\frac{(n_1 - 1) s_1^2 + (n_2 - 1) s_2^2}{n_1 + n_2 - 2}}
$$
</center>

##### Confidence interval for $\mu_1 - \mu_2$ {-}

<center>
$$
(\bar x_1 - \bar x_2) \pm t^*_{df} \times SE(\bar x_1 - \bar x_2)
$$
</center>
where $t^*_{df}$ denotes the critical value corresponding to a desired $\alpha$ level for a $t$-distribution with $df$ degrees of freedom.


##### Validity conditions {-}

These above procedures are considered valid if:

- The sample data arise from independent random samples from two populations OR from random assignment of the units to treatment groups.
- Either the quantitative variable of interest is normally distributed in both populations OR both sample sizes are large (as a convention, $n_1 \geq 20$ and $n_2 \geq 20$) and the sample distributions should not be strongly skewed.
</div>


---

`r msmbstyle::question_begin(header = "&#x25BA; Question 18")`
Use the summary statistics computed in Question 11 to calculate the value of the $t$-statistic for testing the hypotheses stated in Question 7.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
```{r}
n_f <- descr_stats %>% filter(Sex == 'female') %>% pull(SampleSize)
n_m <- descr_stats %>% filter(Sex == 'male') %>% pull(SampleSize)

xbar_f <- descr_stats %>% filter(Sex == 'female') %>% pull(Mean)
xbar_m <- descr_stats %>% filter(Sex == 'male') %>% pull(Mean)

s_f <- descr_stats %>% filter(Sex == 'female') %>% pull(SD)
s_m <- descr_stats %>% filter(Sex == 'male') %>% pull(SD)
```

Can the population variances be assumed equal? We use an hypothesis test which tests

$$
H_0 : \sigma_f = \sigma_m \\
H_1 : \sigma_f \neq \sigma_m
$$

or, equivalently,
$$
H_0 : \frac{\sigma_f}{\sigma_m} = 1 \\
H_1 : \frac{\sigma_f}{\sigma_m} \neq 1
$$

```{r}
var.test(NumberCloseFriends ~ Sex, data = gss)
```

At a significance level of 0.05, the p-value = 0.7937 leads us to not rejecting the null hypothesis of equal variances across the two populations. We then proceed to calculate the standard error of the difference in means using the pooled standard deviation.

```{r}
# Pooled SD
s_p <- sqrt(
  ((n_f - 1) * s_f^2 + (n_m - 1) * s_m^2) / (n_f + n_m - 2)
)

SE <- s_p * sqrt(1/n_f + 1/n_m)

t_stat <- (xbar_f - xbar_m) / SE
t_stat
```
`r msmbstyle::solution_end()`

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 19")`
Compare the $t$-statistic with the appropriate 5% critical value from a $t$-distribution. Compute the $p$-value and interpret the results.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
Critical value:
```{r}
t_crit <- qt(0.975, n_m + n_m - 2)
t_crit
```

$p$-value:
```{r}
p_value <- 2 * (1 - pt(abs(t_stat), n_m + n_m - 2))
p_value
```

At a 5% significance level, the observed difference in mean number of close friends between adult American females and males is significantly different from 0. 

In other words, an observed difference in sample mean number of close friends of `r (xbar_f - xbar_m) %>% round(2)` is highly unlikely to occur by chance alone.

The sample data provide very strong evidence that, on average, adult American females and males tend to not have the same number of close friends.


Verify your results using the built-in R function:
```{r}
t.test(NumberCloseFriends ~ Sex, data = gss, var.equal = TRUE)
```

`r msmbstyle::solution_end()`

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 20")`
State the validity conditions necessary for the two-sample $t$-test to be valid.

Should the strong skewness in the sample distributions cause you any concerns about the validity of your results?
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`

Validity conditions:

- The sample data arise from independent random samples from two populations OR from random assignment of the units to treatment groups.
- Either the quantitative variable of interest is normally distributed in both populations OR both sample sizes are large (as a convention, $n_1 \geq 20$ and $n_2 \geq 20$) and the sample distributions should not be strongly skewed.

Even though the distribution of number of close friends is clearly skewed, the sample sizes (813 and 654) are quite large.  
Also, these data were collected from a random sample of adult Americans.  
Hence, the conditions required for the two-sample t-test results to be valid are satisfied.
`r msmbstyle::solution_end()`

---

`r msmbstyle::question_begin(header = "&#x25BA; Question 21")`
Now that we have established that there is significant evidence of a difference in the population mean number of close friends between females and males, what is the magnitude of this difference in the population means?

Construct and interpret a 95% confidence interval for the difference in population mean number of close friends between females and males.

Pay particular attention on whether the interval is negative, positive, or contains zero.
`r msmbstyle::question_end()`

`r msmbstyle::solution_begin(hidden = HIDDEN_SOLS, toggle = TOGGLE)`
In order to estimate the magnitude of the difference in the population means we can use a confidence interval for the difference in means.

```{r}
ci <- tibble(
  LowerCI = (xbar_f - xbar_m) - t_crit * SE,
  UpperCI = (xbar_f - xbar_m) + t_crit * SE)
ci
```

A 95% confidence interval for the difference in the mean number of close friends between females and males is [0.046, 0.41]. 

The confidence interval is entirely positive, supporting our conclusion that females and males differ with regard to average number of close friends.  We are 95% confident that American females have between 0.046 and 0.41 more close friends, on average, than American males do.
`r msmbstyle::solution_end()`






## Lab: Does name increase tips?


Can a waitress earn higher tips simply by introducing themselves by name when greeting customers?
A study by

```{r}
library(tidyverse)
```





## References {#w17-references}

- Garrity, K., & Degelman, D. (1990). Effect of server introduction on restaurant tipping. _Journal of Applied Social Psychology, 20_(2), 168-172.

_Material adapted from:_

- Rossman, A. J., & Chance, B. L. (2011). _Workshop statistics: discovery with data._ John Wiley & Sons.
