<<<<<<< Updated upstream
<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Type I and Type II Errors, Power! | Data Analysis for Psychology in R (dapR1) - Labs</title>
  <meta name="description" content="This is the page that contains the course labs materials" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Type I and Type II Errors, Power! | Data Analysis for Psychology in R (dapR1) - Labs" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the page that contains the course labs materials" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Type I and Type II Errors, Power! | Data Analysis for Psychology in R (dapR1) - Labs" />
  
  <meta name="twitter:description" content="This is the page that contains the course labs materials" />
  

<meta name="author" content="Department of Psychology, University of Edinburgh" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="chap-normal.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script>
  $(document).ready(function() {
    $head = $('#header');
    $head.prepend('<img style="padding-right:25%; margin-bottom:10px;" src="https://www.ed.ac.uk/sites/all/themes/uoe/assets/logo.png" width="770px" align="left">')
  });
</script>

<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}
}
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DAPR1</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview of the Course</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-team"><i class="fa fa-check"></i>The team</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-cheatsheets"><i class="fa fa-check"></i>R Cheatsheets</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-community"><i class="fa fa-check"></i>R Community</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chap-typeerror.html"><a href="chap-typeerror.html"><i class="fa fa-check"></i><b>1</b> Type I and Type II Errors, Power!</a><ul>
<li class="chapter" data-level="1.1" data-path="chap-typeerror.html"><a href="chap-typeerror.html#overview-of-last-week"><i class="fa fa-check"></i><b>1.1</b> Overview of last week</a></li>
<li class="chapter" data-level="1.2" data-path="chap-typeerror.html"><a href="chap-typeerror.html#walkthrough"><i class="fa fa-check"></i><b>1.2</b> Walkthrough</a><ul>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#example-1-coin-flip"><i class="fa fa-check"></i>Example 1: Coin flip</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#an-analogy"><i class="fa fa-check"></i>An analogy</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#two-different-types-of-errors"><i class="fa fa-check"></i>Two different types of errors</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#type-i-errors"><i class="fa fa-check"></i>Type I errors</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#type-ii-errors-and-power"><i class="fa fa-check"></i>Type II errors and Power</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#example-2-a-biased-coin"><i class="fa fa-check"></i>Example 2: A biased coin</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#generalising-it"><i class="fa fa-check"></i>Generalising it</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#overlapping-distributions"><i class="fa fa-check"></i>Overlapping distributions</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chap-typeerror.html"><a href="chap-typeerror.html#summary"><i class="fa fa-check"></i><b>1.3</b> Summary</a></li>
<li class="chapter" data-level="1.4" data-path="chap-typeerror.html"><a href="chap-typeerror.html#lab"><i class="fa fa-check"></i><b>1.4</b> Lab</a><ul>
<li class="chapter" data-level="1.4.1" data-path="chap-typeerror.html"><a href="chap-typeerror.html#exercise-1-calculating-power-for-a-different-coin."><i class="fa fa-check"></i><b>1.4.1</b> Exercise 1: Calculating power for a different coin.</a></li>
<li class="chapter" data-level="1.4.2" data-path="chap-typeerror.html"><a href="chap-typeerror.html#exercise-2-calculating-sample-size-number-of-flips-for-a-desired-level-of-power"><i class="fa fa-check"></i><b>1.4.2</b> Exercise 2: Calculating sample size (number of flips) for a desired level of power</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap-normal.html"><a href="chap-normal.html"><i class="fa fa-check"></i><b>2</b> Normal distributions &amp; probability</a><ul>
<li class="chapter" data-level="2.1" data-path="chap-normal.html"><a href="chap-normal.html#recap"><i class="fa fa-check"></i><b>2.1</b> Recap</a></li>
<li class="chapter" data-level="2.2" data-path="chap-normal.html"><a href="chap-normal.html#walkthrough-1"><i class="fa fa-check"></i><b>2.2</b> Walkthrough</a><ul>
<li class="chapter" data-level="2.2.1" data-path="chap-normal.html"><a href="chap-normal.html#density-curves"><i class="fa fa-check"></i><b>2.2.1</b> density curves</a></li>
<li class="chapter" data-level="2.2.2" data-path="chap-normal.html"><a href="chap-normal.html#normal-but-different"><i class="fa fa-check"></i><b>2.2.2</b> normal but different</a></li>
<li class="chapter" data-level="2.2.3" data-path="chap-normal.html"><a href="chap-normal.html#parameters"><i class="fa fa-check"></i><b>2.2.3</b> parameters</a></li>
<li class="chapter" data-level="2.2.4" data-path="chap-normal.html"><a href="chap-normal.html#standard-normal"><i class="fa fa-check"></i><b>2.2.4</b> standard normal</a></li>
<li class="chapter" data-level="2.2.5" data-path="chap-normal.html"><a href="chap-normal.html#z-scores"><i class="fa fa-check"></i><b>2.2.5</b> z-scores</a></li>
<li class="chapter" data-level="2.2.6" data-path="chap-normal.html"><a href="chap-normal.html#in-class-activity"><i class="fa fa-check"></i><b>2.2.6</b> In-class activity</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chap-normal.html"><a href="chap-normal.html#lab-1"><i class="fa fa-check"></i><b>2.3</b> Lab</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis for Psychology in R (dapR1) - Labs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap-typeerror" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Type I and Type II Errors, Power!</h1>
<div class="lo">
<h4 id="instructions" class="unnumbered">Instructions</h4>
<ul>
<li>In this two-hour lab we will go through worked examples in the first hour, and you will attempt to answer some questions in the second hour.</li>
<li>The Rmarkdown file for this week is <a href="https://uoe-psychology.github.io/uoe_psystats/dapr1/labsheets/week_14_practice.Rmd">here</a>.</li>
</ul>
<h4 id="learning-outcomes" class="unnumbered">Learning outcomes</h4>
<p><strong>LO1.</strong> Recap hypothesis testing</p>
<p><strong>LO2.</strong> Understand the different types of errors</p>
<p><strong>LO3.</strong> Introduce statistical power</p>
<h4 id="reading" class="unnumbered">Reading</h4>
<p>?????????????????????</p>
</div>
<div id="overview-of-last-week" class="section level2">
<h2><span class="header-section-number">1.1</span> Overview of last week</h2>
<p>Last week we learned to frame a research question in terms of <strong>null</strong> and <strong>alternative</strong> hypotheses about parameters.</p>
<ul>
<li><p>We likened the <strong>null hypothesis</strong> (<span class="math inline">\(H_0\)</span>) to a ‘random chance model’ - i.e., if differences or effects that we observe are actually just due to sampling variation.</p></li>
<li><p>We generated a distribution for the null hypothesis (the <strong>null distribution</strong>) which reflected how much sample statistics would vary due to chance if the null hypothesis is true (e.g., if there really is no difference/effect). We did this by simulating lots of samples and computing the statistic on each of the samples.</p></li>
<li><p>We then compared the observed statistic to the null distribution we had generated. This is equivalent to asking how likely it would be to get our observed statistic if the null hypothesis was actually true. We learned that the <strong>p-value</strong> is the proportion of simulated sample statistics in our null distribution which were as or more extreme than our observed statistic.</p></li>
<li><p>Finally, we thought about how we might make a formal decision about <em>whether or not to reject the null hypothesis</em> based on our p-value.</p></li>
</ul>
<p>This week, we will recap this process of hypothesis testing, before thinking about the ways in which this method might lead to error.</p>
</div>
<div id="walkthrough" class="section level2">
<h2><span class="header-section-number">1.2</span> Walkthrough</h2>
<div id="example-1-coin-flip" class="section level3 unnumbered">
<h3>Example 1: Coin flip</h3>
<div style="background-image: url(&#39;flipping.jpg&#39;)">
<h4 id="research-question-hypotheses" class="unnumbered">Research Question &amp; Hypotheses</h4>
<p>Is our coin biased?
<br><br>
<em>Null hypothesis</em>: We’re just as likely to get heads as tails when we flip the coin.
<span class="math display">\[H_0: p = 0.5\]</span>
<em>Alternative hypothesis</em>: We’re more likely to see either heads or tails when we flip the coin.
<span class="math display">\[H_1: p \neq 0.5\]</span></p>
<h4 id="data-collection" class="unnumbered">Data collection</h4>
<p>We flip the coin 90 times, and it lands on heads 55 times.</p>
</div>
<div id="analysis" class="section level4 unnumbered">
<h4>Analysis</h4>
<div class="red">
<p><br>
<strong>Steps</strong>
<br></p>
<ol style="list-style-type: decimal">
<li>Calculate our statistic<br />
</li>
<li>Generate the null distribution<br />
</li>
<li>Calculate the probability of seeing our statistic (or one which is farther away from the null) if the null were true (this is the p-value)</li>
</ol>
</div>
<p><strong>1. Calculate our statistic, <span class="math inline">\(\hat{p}\)</span></strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">p_hat &lt;-<span class="st"> </span><span class="dv">55</span><span class="op">/</span><span class="dv">90</span></a>
<a class="sourceLine" id="cb1-2" title="2">p_hat</a></code></pre></div>
<pre><code>## [1] 0.6111111</code></pre>
<p><strong>2. Generate the null distribution</strong></p>
<div class="noteBox">
<p>Remember that the null distribution is what we would expect if the null hypothesis were true - it is how much the statistics computed from samples of size <span class="math inline">\(n\)</span> would vary if the null is true.<br />
In our case, this quantifies how much our statistic (the proportion of heads) in a sample of size 90 would vary if the true probability of the coin landing on heads were 1/2.</p>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># Specify our possible outcomes and their probabilities under the null</span></a>
<a class="sourceLine" id="cb3-2" title="2">outcomes &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">vals =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&#39;Heads&#39;</span>, <span class="st">&#39;Tails&#39;</span>)))</a>
<a class="sourceLine" id="cb3-3" title="3">prob &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co"># generate samples under the null</span></a>
<a class="sourceLine" id="cb3-6" title="6">samples &lt;-<span class="st"> </span><span class="kw">rep_sample_n</span>(outcomes, <span class="dt">size =</span> <span class="dv">90</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">prob =</span> prob)</a>
<a class="sourceLine" id="cb3-7" title="7"></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co"># calculate the statistics for each sample to create the null distribution</span></a>
<a class="sourceLine" id="cb3-9" title="9">null_distribution &lt;-<span class="st"> </span>samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">prop =</span> <span class="kw">sum</span>(vals <span class="op">==</span><span class="st"> &#39;Heads&#39;</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>())</a></code></pre></div>
<p>and we can now plot our null distribution:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">ggplot</span>(null_distribution, <span class="kw">aes</span>(<span class="dt">x =</span> prop)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw">geom_dotplot</span>(<span class="dt">binwidth =</span> <span class="fl">0.01</span>, <span class="dt">dotsize =</span> <span class="fl">0.5</span>, <span class="dt">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="dt">stackratio =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expr</span>(<span class="kw">hat</span>(p)))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>And plot the observed statistic on top, like we did last week.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">ggplot</span>(null_distribution, <span class="kw">aes</span>(<span class="dt">x =</span> prop, <span class="dt">fill =</span> (prop <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.61</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="st">  </span><span class="kw">geom_dotplot</span>(<span class="dt">binwidth =</span> <span class="fl">0.01</span>, <span class="dt">dotsize =</span> <span class="fl">0.5</span>, <span class="dt">stackratio =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&#39;white&#39;</span>, <span class="st">&#39;tomato1&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.61</span>, <span class="dt">color =</span> <span class="st">&#39;tomato1&#39;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expr</span>(<span class="kw">hat</span>(p)), <span class="dt">fill =</span> <span class="kw">expr</span>(<span class="kw">hat</span>(p) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.61</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p><strong>3. Calculate our p-value</strong><br />
<br>
How surprising is 55 of 90 coin flips? We can compare it against the null distribution.</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>What is our p-value?</p>
<ol style="list-style-type: decimal">
<li>The proportion of the null distribution which is <span class="math inline">\(\geq0.61\)</span></li>
<li>The proportion of the null distribution which is <span class="math inline">\(\geq0.61\)</span> or <span class="math inline">\(\leq0.39\)</span><br />
</li>
<li>2 times the proportion of the null distribution which is <span class="math inline">\(\geq0.61\)</span></li>
</ol>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-78" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-78&#39;, &#39;sol-start-78&#39;)"></span>
</p>
<div id="sol-body-78" class="solution-body" style="display: none;">
<p>If we perform an hypothesis test for the two-sided alternative <span class="math inline">\(p \neq 0.5\)</span>, we compute it as twice the proportion in the smallest tail.</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">pvalue &lt;-<span class="st"> </span>null_distribution <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb6-3" title="3">    <span class="dt">pvalue_lefttail =</span> <span class="kw">sum</span>(prop <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.39</span> <span class="op">|</span><span class="st"> </span>prop<span class="op">&gt;=</span><span class="fl">0.61</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb6-4" title="4">  )</a></code></pre></div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>What is our formal decision about our hypotheses?</p>
<ol style="list-style-type: decimal">
<li>Not enough evidence to reject <span class="math inline">\(H_0\)</span><br>(<span class="math inline">\(H_0:\)</span> We’re just as likely to get heads as tails when we flip the coin.)</li>
<li>Evidence in favour of <span class="math inline">\(H_1\)</span><br>(<span class="math inline">\(H_1:\)</span> We’re more likely to see either heads or tails when we flip the coin.)</li>
</ol>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-79" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-79&#39;, &#39;sol-start-79&#39;)"></span>
</p>
<div id="sol-body-79" class="solution-body" style="display: none;">
<p>According to our p-value, we have reason to reject the null hypothesis that our coin will land on heads and tails equally often.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
</div>
<div id="an-analogy" class="section level3 unnumbered">
<h3>An analogy</h3>
<p>Might we have made a mistake here? Is 55 out of 90 coin flips <em>surprising enough</em> for us to reject the hypothesis that the coin is fair?<br />
<br>
Last week we discussed an analogy in law, in which a person on trial is presumed innocent until proven guilty. Similarly, we presume <span class="math inline">\(H_0\)</span> to be true until there is strong evidence to reject it. How strong must the evidence be? How do we avoid wrongly convicting an innocent person? (i.e., wrongly rejecting an hypothesis which is actually true?)</p>
</div>
<div id="two-different-types-of-errors" class="section level3 unnumbered">
<h3>Two different types of errors</h3>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Person is innocent</th>
<th align="center">Person is guilty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Verdict = Innocent</td>
<td align="center">Correct decision</td>
<td align="center">Criminal goes free</td>
</tr>
<tr class="even">
<td align="left">Verdict = Guilty</td>
<td align="center">Wrongful conviction</td>
<td align="center">Correct decision</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center"><span class="math inline">\(H_0\)</span> is True</th>
<th align="center"><span class="math inline">\(H_0\)</span> is False</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Test doesn’t reject <span class="math inline">\(H_0\)</span></td>
<td align="center">Correct decision</td>
<td align="center">Type II Error<br>(<span class="math inline">\(\beta\)</span>)</td>
</tr>
<tr class="even">
<td align="left">Test rejects <span class="math inline">\(H_0\)</span></td>
<td align="center">Type I Error<br>(<span class="math inline">\(\alpha\)</span>)</td>
<td align="center">Correct decision</td>
</tr>
</tbody>
</table>
</div>
<div id="type-i-errors" class="section level3 unnumbered">
<h3>Type I errors</h3>
<p>If the null hypothesis is true, then the <strong>sampling distribution</strong> of our statistic follows the null distribution which we constructed above, and we will reject (incorrectly) any sample statistic which results in a p-value which is less than or equal to our <span class="math inline">\(\alpha\)</span> level (e.g., the 0.05 we set earlier).
<br>
So the probability of making this error is equal to the <span class="math inline">\(alpha\)</span> level which we set.<br />
<br>
In other words, when the null hypothesis is true, 0.05 (or 5%) of the random samples we could take would result in us rejecting it.</p>
<div class="noteBox">
<h4 id="a-thought-experiment" class="unnumbered">A thought experiment</h4>
<ul>
<li>there are 20 researchers.</li>
<li>each researcher has a perfectly balanced/fair coin.<br />
</li>
<li>each researcher conducts a statistical test at <span class="math inline">\(\alpha = 0.05\)</span> to evaluate whether their coin is fair (lands on heads equally as often as it lands on tails).</li>
</ul>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>How many of the researchers’ tests would we expect to result in a type I error?<br />
<small><strong>Remember:</strong> The probability of making a Type I error is the probability of getting an unlikely sample statistic simply due to chance sampling variation (i.e., we just happen to get a random sample with an unlikely statistic).</small></p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-80" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-80&#39;, &#39;sol-start-80&#39;)"></span>
</p>
<div id="sol-body-80" class="solution-body" style="display: none;">
<p>This is similar to asking “What is the probability of observing at least one significant result due to chance sampling variation alone?”. We can work this out..
<br></p>
<ul>
<li><p>For one researcher, if their null hypothesis is true, the probability that they get a significant result is 0.05,and the probability that they get a non-significant result (p-value <span class="math inline">\(&gt; 0.05\)</span>) is 0.95.</p></li>
<li><p>If there are 20 researchers, the probability of them <em>all</em> getting <em>non-significant</em> results when their null hypotheses are all true is <span class="math inline">\(0.95^{20} = 0.358\)</span></p></li>
<li><p>This means that the robability of the opposite - <em>at least one</em> of them gets a significant result even though all their nulls are true - is <span class="math inline">\(1 - 0.358 = 0.642\)</span></p></li>
</ul>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
</div>
<div id="type-ii-errors-and-power" class="section level3 unnumbered">
<h3>Type II errors and Power</h3>
<p>The other kind of error we might make is a type II error, and is denoted by <span class="math inline">\(\beta\)</span>.<br>
This happens when <span class="math inline">\(H_0\)</span> is false, but we do not have enough evidence to reject it.</p>
<p>In our table, the columns specify the possible states of the world (<span class="math inline">\(H_0\)</span> is either True or False).<br />
<br>
In each of the possible states of the world, there are two potential outcomes of conducting a statistical test (Reject <span class="math inline">\(H-0\)</span> or Don’t reject <span class="math inline">\(H_0\)</span>).<br />
<br>
We have seen that:
+ <em>if <span class="math inline">\(H_0\)</span> is true</em>, then the probability of incorrectly rejecting <span class="math inline">\(H_0\)</span> is <span class="math inline">\(\alpha\)</span> (often set at 0.05), and the probability of correctly retaining (not rejecting) <span class="math inline">\(H_0\)</span> is 0.95.<br />
+ <em>if <span class="math inline">\(H_0\)</span> is false</em>, then the probability of incorrectly failing to reject <span class="math inline">\(H_0\)</span> is <span class="math inline">\(\beta\)</span>, and the probability of correctly rejecting <span class="math inline">\(H_0\)</span> is <span class="math inline">\(1-\beta\)</span>. This is known as the <strong>statistical power</strong> of our test.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center"><span class="math inline">\(H_0\)</span> is True</th>
<th align="center"><span class="math inline">\(H_0\)</span> is False</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Test doesn’t reject <span class="math inline">\(H_0\)</span></td>
<td align="center">Correct<br><strong>1-<span class="math inline">\(\alpha\)</span></strong></td>
<td align="center">Type II Error<br>(<span class="math inline">\(\beta\)</span>)</td>
</tr>
<tr class="even">
<td align="left">Test rejects <span class="math inline">\(H_0\)</span></td>
<td align="center">Type I Error<br>(<span class="math inline">\(\alpha\)</span>)</td>
<td align="center">Correct<br><strong>1-<span class="math inline">\(\beta\)</span></strong><br><strong>Power</strong></td>
</tr>
</tbody>
</table>
<div class="def">
<h4 id="statistical-power" class="unnumbered">Statistical power</h4>
<p>Statistical power is the probability of a hypothesis test of finding an effect if there is an effect to be found.</p>
</div>
</div>
<div id="example-2-a-biased-coin" class="section level3 unnumbered">
<h3>Example 2: A biased coin</h3>
<p>I have a trick coin which is weighted so that it lands on heads 60% of the time (rather than the usual 50% for a normal fair coin).
<br>
Oh no! Tom has noticed that whenever we flip a coin, I always call heads, and I often seem. He accuses me of cheating by using a trick coin which is biased to land on!
I make him an offer: he can flip the coin 50 times in order to decide whether or not it really is a trick coin.</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>In Tom’s 50 coin flips, what proportion of heads would lead him to the correct conclusion that the coin is a trick coin?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-81" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-81&#39;, &#39;sol-start-81&#39;)"></span>
</p>
<div id="sol-body-81" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># Specify our possible outcomes and their probabilities under the null</span></a>
<a class="sourceLine" id="cb7-2" title="2">outcomes &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">vals =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&#39;Heads&#39;</span>, <span class="st">&#39;Tails&#39;</span>)))</a>
<a class="sourceLine" id="cb7-3" title="3">prob &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb7-4" title="4"></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co"># generate samples under the null</span></a>
<a class="sourceLine" id="cb7-6" title="6">samples &lt;-<span class="st"> </span><span class="kw">rep_sample_n</span>(outcomes, <span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">prob =</span> prob)</a>
<a class="sourceLine" id="cb7-7" title="7"></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co"># calculate the statistics for each sample to create the null distribution</span></a>
<a class="sourceLine" id="cb7-9" title="9">null_distribution &lt;-<span class="st"> </span>samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">prop =</span> <span class="kw">sum</span>(vals <span class="op">==</span><span class="st"> &#39;Heads&#39;</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>())</a></code></pre></div>
<p>Now that we have generated the null distribution which Tom will use to test his observed statistic, we need to work out at what values he will reject the null.<br>
In other words, we need to work out where the top 5% of the null distribution is?<br>
<br>
Note that we are only looking at the top 5% because Tom thinks the coin is biased <em>towards heads</em>. So his alternative hypothesis (<span class="math inline">\(H_A\)</span>) is <span class="math inline">\(p &gt; 0.5\)</span>, and he will reject <span class="math inline">\(H_0\)</span> if his observed statistic falls in the top end of the distribution.</p>
<!-- this needs explanation. i order the data by prop, and look at the 25th and 950th row.  -->
<!-- we could introduce indexing???? null_distribution[c(25,975),]?? -->
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">null_distribution &lt;-<span class="st"> </span>null_distribution <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="st">  </span><span class="kw">arrange</span>(prop) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">idx =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co"># plot the null distribution</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co"># ggplot(null_distribution, aes(x = prop, fill = (idx &gt;= 975 | idx &lt;= 25))) + </span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#   geom_dotplot(binwidth = 0.01, dotsize = 0.5, stackratio = 0.5) +</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#   scale_fill_manual(values = c(&#39;white&#39;, &#39;tomato1&#39;)) +</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#   labs(x = expr(hat(p)))</span></a>
<a class="sourceLine" id="cb8-10" title="10"></a>
<a class="sourceLine" id="cb8-11" title="11">null_distribution <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="st">  </span><span class="kw">filter</span>(idx <span class="op">==</span><span class="st"> </span><span class="dv">950</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   replicate  prop   idx
##       &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
## 1        92  0.62   950</code></pre>
<p>If Tom flips the coin 50 times, under the null hypothesis, he would need to get a sample statistic (<span class="math inline">\(\hat{p}\)</span>) of greater than or equal to 0.62.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Things we know so far:</p>
<ul>
<li>The coin is rigged to land on heads on 60% of flips - the true probability of heads is 0.6.</li>
<li>If 62% or more of Tom’s 50 coin flips come up heads, then he will reject his null hypothesis (that the coin is fair)</li>
</ul>
<p>What’s the probability that Tom’s 50 flips will come up with 62% or more heads?
<br>
In other words, what is the <em>power</em> of his test?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-82" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-82&#39;, &#39;sol-start-82&#39;)"></span>
</p>
<div id="sol-body-82" class="solution-body" style="display: none;">
<p>We can do this by generating the sampling distribution for when the coin is biased towards heads 60% of the time (which we know is actually true).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">outcomes &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">vals =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&#39;Heads&#39;</span>, <span class="st">&#39;Tails&#39;</span>)))</a>
<a class="sourceLine" id="cb10-2" title="2">prob &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>)</a>
<a class="sourceLine" id="cb10-3" title="3"></a>
<a class="sourceLine" id="cb10-4" title="4">samples &lt;-<span class="st"> </span><span class="kw">rep_sample_n</span>(outcomes, <span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">prob =</span> prob)</a>
<a class="sourceLine" id="cb10-5" title="5"></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co"># calculate the statistics for each sample to create the true distribution</span></a>
<a class="sourceLine" id="cb10-7" title="7">true_distribution &lt;-<span class="st"> </span>samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">prop =</span> <span class="kw">sum</span>(vals <span class="op">==</span><span class="st"> &#39;Heads&#39;</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb10-10" title="10"></a>
<a class="sourceLine" id="cb10-11" title="11">true_distribution <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb10-13" title="13">    <span class="dt">prob_crit =</span> <span class="kw">sum</span>(prop <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.62</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>()</a>
<a class="sourceLine" id="cb10-14" title="14">  )</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   prob_crit
##       &lt;dbl&gt;
## 1     0.463</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="generalising-it" class="section level3 unnumbered">
<h3>Generalising it</h3>
<ol style="list-style-type: decimal">
<li>When we conduct NHST, we set <span class="math inline">\(\alpha\)</span>.<br />
</li>
<li>In setting <span class="math inline">\(\alpha\)</span>, we define a <strong>critical region</strong> under the null distribution. The <strong>critical value</strong> is the value of the statistic which defines the start of this region. Any statistic more extreme than this will result in rejecting the null hypothesis.</li>
<li>If the null hypothesis is false, the probability that we reject the null hypothesis depends on a) how far away from the null hypothesis the true state of the world is, and b) our sample size.</li>
<li>In our example, we <em>knew</em> the true bias of the coin. But Tom didn’t! What Tom <em>could</em> do, is calculate the power of his test <em>assuming</em> a given value for <span class="math inline">\(p\)</span>. He might have thought to himself “hmm, that coin seems to land on heads about 3/4 of the time. I want to know the probability of me being able to correctly reject the null hypothesis is, if the coin is actually biased that much”.<br>
The important thing is that, given an assumed <strong>effect size</strong> (i.e., difference from the null hypothesis), we can compute the power of a test based on our given sample size. This corresponds to the probability of getting a statistic more extreme than the critical value, given a theorised effect size.<br>
<small>Had Tom used the code above he might have called his distribution <code>theoretical_distribution</code> rather than <code>true_distribution</code>!</small></li>
</ol>
</div>
<div id="overlapping-distributions" class="section level3 unnumbered">
<h3>Overlapping distributions</h3>
<p>Talk through applet</p>
<p><a href="https://istats.shinyapps.io/power/" class="uri">https://istats.shinyapps.io/power/</a>
<a href="https://rpsychologist.com/d3/NHST/" class="uri">https://rpsychologist.com/d3/NHST/</a></p>
</div>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">1.3</span> Summary</h2>
</div>
<div id="lab" class="section level2">
<h2><span class="header-section-number">1.4</span> Lab</h2>
<div id="exercise-1-calculating-power-for-a-different-coin." class="section level3">
<h3><span class="header-section-number">1.4.1</span> Exercise 1: Calculating power for a different coin.</h3>
<p>If my trick coin was actually weighted so that it landed on heads 75% of the time, what would the power of Tom’s test (50 flips) be?</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-83" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-83&#39;, &#39;sol-start-83&#39;)"></span>
</p>
<div id="sol-body-83" class="solution-body" style="display: none;">
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="exercise-2-calculating-sample-size-number-of-flips-for-a-desired-level-of-power" class="section level3">
<h3><span class="header-section-number">1.4.2</span> Exercise 2: Calculating sample size (number of flips) for a desired level of power</h3>
<div class="red">
<p><br>
For a given <strong>effect size</strong> (i.e., assumed difference from the null hypothesis), we can compute the power of a test based on a given sample size.<br>
So, in testing a biased coin, we can calculate the power of a test for different possible biases of coin (e.g., assuming the coin to be biased towards heads 55%, 60%, 75% of the time).<br />
<br>
Importantly, we can also decide on what we want the power of a test to be, and ask what the minimum sample size is that is needed to detect a given effect size.</p>
</div>
<p>Q2 - Assuming the coin to be biased towards landing on heads 75% of the time, how many coin flips should Tom do in order to increase his power to 80%?</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-84" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-84&#39;, &#39;sol-start-84&#39;)"></span>
</p>
<div id="sol-body-84" class="solution-body" style="display: none;">
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap-normal.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
=======
<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Type I and Type II Errors, Power! | Data Analysis for Psychology in R (dapR1) - Labs</title>
  <meta name="description" content="This is the page that contains the course labs materials" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Type I and Type II Errors, Power! | Data Analysis for Psychology in R (dapR1) - Labs" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the page that contains the course labs materials" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Type I and Type II Errors, Power! | Data Analysis for Psychology in R (dapR1) - Labs" />
  
  <meta name="twitter:description" content="This is the page that contains the course labs materials" />
  

<meta name="author" content="Department of Psychology, University of Edinburgh" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="chap-normal.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script>
  $(document).ready(function() {
    $head = $('#header');
    $head.prepend('<img style="padding-right:25%; margin-bottom:10px;" src="https://www.ed.ac.uk/sites/all/themes/uoe/assets/logo.png" width="770px" align="left">')
  });
</script>

<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}
}
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DAPR1</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview of the Course</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-team"><i class="fa fa-check"></i>The team</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-cheatsheets"><i class="fa fa-check"></i>R Cheatsheets</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-community"><i class="fa fa-check"></i>R Community</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chap-typeerror.html"><a href="chap-typeerror.html"><i class="fa fa-check"></i><b>1</b> Type I and Type II Errors, Power!</a><ul>
<li class="chapter" data-level="1.1" data-path="chap-typeerror.html"><a href="chap-typeerror.html#recap"><i class="fa fa-check"></i><b>1.1</b> Recap</a></li>
<li class="chapter" data-level="1.2" data-path="chap-typeerror.html"><a href="chap-typeerror.html#walkthrough"><i class="fa fa-check"></i><b>1.2</b> Walkthrough</a><ul>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#example-1-coin-flip"><i class="fa fa-check"></i>Example 1: Coin flip</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#an-analogy"><i class="fa fa-check"></i>An analogy</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#two-different-types-of-errors"><i class="fa fa-check"></i>Two different types of errors</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#type-i-errors"><i class="fa fa-check"></i>Type I errors</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#type-ii-errors-and-power"><i class="fa fa-check"></i>Type II errors and Power</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#example-2-a-biased-coin"><i class="fa fa-check"></i>Example 2: A biased coin</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#generalising-it"><i class="fa fa-check"></i>Generalising it</a></li>
<li class="chapter" data-level="" data-path="chap-typeerror.html"><a href="chap-typeerror.html#overlapping-distributions"><i class="fa fa-check"></i>Overlapping distributions</a></li>
<li class="chapter" data-level="1.2.1" data-path="chap-typeerror.html"><a href="chap-typeerror.html#in-class-activity"><i class="fa fa-check"></i><b>1.2.1</b> In-class activity</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chap-typeerror.html"><a href="chap-typeerror.html#lab"><i class="fa fa-check"></i><b>1.3</b> Lab</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap-normal.html"><a href="chap-normal.html"><i class="fa fa-check"></i><b>2</b> Normal distributions &amp; probability</a><ul>
<li class="chapter" data-level="2.1" data-path="chap-normal.html"><a href="chap-normal.html#recap-1"><i class="fa fa-check"></i><b>2.1</b> Recap</a></li>
<li class="chapter" data-level="2.2" data-path="chap-normal.html"><a href="chap-normal.html#walkthrough-1"><i class="fa fa-check"></i><b>2.2</b> Walkthrough</a><ul>
<li class="chapter" data-level="2.2.1" data-path="chap-normal.html"><a href="chap-normal.html#density-curves"><i class="fa fa-check"></i><b>2.2.1</b> density curves</a></li>
<li class="chapter" data-level="2.2.2" data-path="chap-normal.html"><a href="chap-normal.html#normal-but-different"><i class="fa fa-check"></i><b>2.2.2</b> normal but different</a></li>
<li class="chapter" data-level="2.2.3" data-path="chap-normal.html"><a href="chap-normal.html#parameters"><i class="fa fa-check"></i><b>2.2.3</b> parameters</a></li>
<li class="chapter" data-level="2.2.4" data-path="chap-normal.html"><a href="chap-normal.html#standard-normal"><i class="fa fa-check"></i><b>2.2.4</b> standard normal</a></li>
<li class="chapter" data-level="2.2.5" data-path="chap-normal.html"><a href="chap-normal.html#z-scores"><i class="fa fa-check"></i><b>2.2.5</b> z-scores</a></li>
<li class="chapter" data-level="2.2.6" data-path="chap-normal.html"><a href="chap-normal.html#in-class-activity-1"><i class="fa fa-check"></i><b>2.2.6</b> In-class activity</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chap-normal.html"><a href="chap-normal.html#lab-1"><i class="fa fa-check"></i><b>2.3</b> Lab</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis for Psychology in R (dapR1) - Labs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap-typeerror" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Type I and Type II Errors, Power!</h1>
<div class="lo">
<h4 id="instructions" class="unnumbered">Instructions</h4>
<ul>
<li>In this two-hour lab we will go through worked examples in the first hour, and you will attempt to answer some questions in the second hour.</li>
<li>The Rmarkdown file for this week is <a href="https://uoe-psychology.github.io/uoe_psystats/dapr1/labsheets/week_14_practice.Rmd">here</a>.</li>
</ul>
<h4 id="learning-outcomes" class="unnumbered">Learning outcomes</h4>
<p><strong>LO1.</strong> Recap hypothesis testing</p>
<p><strong>LO2.</strong> Understand the different types of errors</p>
<p><strong>LO3.</strong> Introduce statistical power</p>
<h4 id="reading" class="unnumbered">Reading</h4>
<p>?????????????????????</p>
</div>
<div id="recap" class="section level2">
<h2><span class="header-section-number">1.1</span> Recap</h2>
<ol style="list-style-type: decimal">
<li>random chance</li>
<li>alternative explanation</li>
<li>statistical hypothesis HoHa!</li>
<li>from random chance model, we constructed a null distribution.(lab involved bootstrapping the null)</li>
<li>compare observed statistic to null distribution</li>
<li>retrieved p-value (proportion of null distribution at least as extreme as observed)</li>
<li>made a formal decision.</li>
</ol>
</div>
<div id="walkthrough" class="section level2">
<h2><span class="header-section-number">1.2</span> Walkthrough</h2>
<div id="example-1-coin-flip" class="section level3 unnumbered">
<h3>Example 1: Coin flip</h3>
<div style="background-image: url(&#39;flipping.jpg&#39;)">
<h4 id="research-question-hypotheses" class="unnumbered">Research Question &amp; Hypotheses</h4>
<p>Is our coin biased?
<br><br>
<em>Null hypothesis</em>: We’re just as likely to get heads as tails when we flip the coin.
<span class="math display">\[H_0: p_{heads} = 0.5\]</span>
<em>Alternative hypothesis</em>: We’re more likely to see either heads or tails when we flip the coin.
<span class="math display">\[H_1: p_{heads} \neq 0.5\]</span></p>
<h4 id="data-collection" class="unnumbered">Data collection</h4>
<p>We flip the coin 90 times, and it lands on heads 54 times.</p>
</div>
<div id="analysis" class="section level4 unnumbered">
<h4>Analysis</h4>
<div class="red">
<p><br>
<strong>Steps</strong>
<br></p>
<ol style="list-style-type: decimal">
<li>Calculate our statistic<br />
</li>
<li>Generate the null distribution<br />
</li>
<li>Calculate the probability of seeing our statistic (or one which is more extremely different the null) if the null were true (the p-value)</li>
</ol>
</div>
<ol style="list-style-type: decimal">
<li>Calculate our statistic, <span class="math inline">\(\hat{p}\)</span></li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">p_hat &lt;-<span class="st"> </span><span class="dv">55</span><span class="op">/</span><span class="dv">90</span></a>
<a class="sourceLine" id="cb2-2" title="2">p_hat</a></code></pre></div>
<pre><code>## [1] 0.6111111</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Generate the null distribution</li>
</ol>
<p>Is our 54 of 90 coin flips that surprising?<br>
Let’s compare it against the null distribution.<br>
Remember that the null distribution is what we would expect if the null hypothesis were true - it is how much the statistics computed from samples of size <span class="math inline">\(n\)</span> would vary if the null is true. In our case, this quantifies how much our statistic (the proportion of heads) in a sample of size 90 would vary if the true probability of the coin landing on heads were 1/2.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Specify our possible outcomes and their probabilities under the null</span></a>
<a class="sourceLine" id="cb4-2" title="2">outcomes &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">vals =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&#39;Heads&#39;</span>, <span class="st">&#39;Tails&#39;</span>)))</a>
<a class="sourceLine" id="cb4-3" title="3">prob &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-4" title="4"></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co"># generate samples under the null</span></a>
<a class="sourceLine" id="cb4-6" title="6">samples &lt;-<span class="st"> </span><span class="kw">rep_sample_n</span>(outcomes, <span class="dt">size =</span> <span class="dv">90</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">prob =</span> prob)</a>
<a class="sourceLine" id="cb4-7" title="7"></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co"># calculate the statistics for each sample to create the null distribution</span></a>
<a class="sourceLine" id="cb4-9" title="9">null_distribution &lt;-<span class="st"> </span>samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">prop =</span> <span class="kw">sum</span>(vals <span class="op">==</span><span class="st"> &#39;Heads&#39;</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb4-12" title="12"></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co"># plot the null distribution  </span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="kw">ggplot</span>(null_distribution, <span class="kw">aes</span>(<span class="dt">x =</span> prop)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="st">  </span><span class="kw">geom_dotplot</span>(<span class="dt">binwidth =</span> <span class="fl">0.01</span>, <span class="dt">dotsize =</span> <span class="fl">0.5</span>, <span class="dt">fill =</span> <span class="st">&#39;white&#39;</span>, <span class="dt">stackratio =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expr</span>(<span class="kw">hat</span>(p)))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>And plot the observed statistic on top, like we did last week.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">ggplot</span>(null_distribution, <span class="kw">aes</span>(<span class="dt">x =</span> prop, <span class="dt">fill =</span> (prop <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.61</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="st">  </span><span class="kw">geom_dotplot</span>(<span class="dt">binwidth =</span> <span class="fl">0.01</span>, <span class="dt">dotsize =</span> <span class="fl">0.5</span>, <span class="dt">stackratio =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&#39;white&#39;</span>, <span class="st">&#39;tomato1&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.61</span>, <span class="dt">color =</span> <span class="st">&#39;tomato1&#39;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expr</span>(<span class="kw">hat</span>(p)), <span class="dt">fill =</span> <span class="kw">expr</span>(<span class="kw">hat</span>(p) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.61</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Calculate our p-value</li>
</ol>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>What is our p-value?</p>
<ol style="list-style-type: decimal">
<li>The proportion of the null distribution which is <span class="math inline">\(\geq0.61\)</span></li>
<li>The proportion of the null distribution which is <span class="math inline">\(\geq0.61\)</span> or <span class="math inline">\(\leq0.39\)</span><br />
</li>
<li>2 times the proportion of the null distribution which is <span class="math inline">\(\geq0.61\)</span> or <span class="math inline">\(\leq0.39\)</span> (whichever is smallest)</li>
</ol>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-1" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-1&#39;, &#39;sol-start-1&#39;)"></span>
</p>
<div id="sol-body-1" class="solution-body" style="display: none;">
<p>if we perform an hypothesis test for the two-sided alternative <span class="math inline">\(p \neq ...\)</span>, we compute it as twice the proportion in the smallest tail, i.e. the tail with the smallest count.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">pvalue &lt;-<span class="st"> </span>null_distribution <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb6-3" title="3">    <span class="dt">pvalue_lefttail =</span> <span class="kw">sum</span>(prop <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.39</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb6-4" title="4">    <span class="dt">pvalue_righttail =</span> <span class="kw">sum</span>(prop <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.61</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>()</a>
<a class="sourceLine" id="cb6-5" title="5">  )</a>
<a class="sourceLine" id="cb6-6" title="6"></a>
<a class="sourceLine" id="cb6-7" title="7">pvalue</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   pvalue_lefttail pvalue_righttail
##             &lt;dbl&gt;            &lt;dbl&gt;
## 1           0.018            0.022</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="fl">0.018</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<pre><code>## [1] 0.036</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>What is our formal decision about our hypotheses?</p>
<ol style="list-style-type: decimal">
<li>Not enough evidence to reject <span class="math inline">\(H_0\)</span> (<span class="math inline">\(H_0:\)</span> We’re just as likely to get heads as tails when we flip the coin.)</li>
<li>Evidence in favour of <span class="math inline">\(H_1\)</span> (<span class="math inline">\(H_1:\)</span> We’re more likely to see either heads or tails when we flip the coin.)</li>
</ol>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-2" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-2&#39;, &#39;sol-start-2&#39;)"></span>
</p>
<div id="sol-body-2" class="solution-body" style="display: none;">
<p>According to our p-value, we have reason to reject the null hypothesis that our coin will land on heads and tails equally often.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
</div>
<div id="an-analogy" class="section level3 unnumbered">
<h3>An analogy</h3>
<p>Have we made an mistake here?
<br>
Is 55 out of 90 coin flips <em>surprising enough</em>?</p>
<p>Last week we discussed an analogy in law, in which a person on trial is presumed innocent until proven guilty. Similarly, we presume <span class="math inline">\(H_0\)</span> to be true until there is strong evidence to reject it.
<br>
How strong must the evidence be? Have we just wrongly convicted an innocent person? (i.e., wrongly rejected an hypothesis which is actually true?)</p>
</div>
<div id="two-different-types-of-errors" class="section level3 unnumbered">
<h3>Two different types of errors</h3>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Person is innocent</th>
<th align="center">Person is guilty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Verdict = Innocent</td>
<td align="center">Correct decision</td>
<td align="center">Criminal goes free</td>
</tr>
<tr class="even">
<td align="left">Verdict = Guilty</td>
<td align="center">Wrongful conviction</td>
<td align="center">Correct decision</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center"><span class="math inline">\(H_0\)</span> is True</th>
<th align="center"><span class="math inline">\(H_0\)</span> is False</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Test doesn’t reject <span class="math inline">\(H_0\)</span></td>
<td align="center">Correct</td>
<td align="center">Type II Error<br>(<span class="math inline">\(\beta\)</span>)</td>
</tr>
<tr class="even">
<td align="left">Test rejects <span class="math inline">\(H_0\)</span></td>
<td align="center">Type I Error<br>(<span class="math inline">\(\alpha\)</span>)</td>
<td align="center">Correct</td>
</tr>
</tbody>
</table>
</div>
<div id="type-i-errors" class="section level3 unnumbered">
<h3>Type I errors</h3>
<p><em>if</em> the null hypothesis is true, then the sampling distribution of our statistic is the null distribution (plotted above), and we will reject (incorrectly) any sample statistic which results in a p-value which is less than or equal to our <span class="math inline">\(\alpha\)</span> level (e.g., the 0.05 we set earlier).
<br>
So the probability of making this error is equal to the <span class="math inline">\(alpha\)</span> level which we set.</p>
<div class="noteBox">
<h4 id="a-thought-experiment" class="unnumbered">A thought experiment</h4>
<ul>
<li>there are 20 researchers.</li>
<li>each researcher has a perfectly balanced/fair coin.<br />
</li>
<li>each researcher conducts a statistical test at <span class="math inline">\(\alpha = 0.05\)</span> to evaluate whether their coin is fair (lands on heads equally as often as it lands on tails).</li>
</ul>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>How many of the researchers’ tests would we expect to result in a type I error?<br />
<small><strong>Remember:</strong> The probability of making a Type I error is the probability of getting an unlikely sample statistic simply due to chance sampling variation (i.e., we just happen to get a random sample with an unlikely statistic).</small></p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-3" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-3&#39;, &#39;sol-start-3&#39;)"></span>
</p>
<div id="sol-body-3" class="solution-body" style="display: none;">
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
</div>
<div id="type-ii-errors-and-power" class="section level3 unnumbered">
<h3>Type II errors and Power</h3>
<p>A type II error is denoted by <span class="math inline">\(\beta\)</span>. <br>
This happens when <span class="math inline">\(H_0\)</span> is false, but we do not have enough evidence to reject it.</p>
<!-- this can happen when.. -->
<p>In our table, the columns specify the possible states of the world (<span class="math inline">\(H_0\)</span> is either True or False).
<br>
In each of the possible states of the world, there are two potential outcomes of conducting a statistical test (Reject <span class="math inline">\(H-0\)</span> or Don’t reject <span class="math inline">\(H_0\)</span>).
<br>
We have seen that <em>if <span class="math inline">\(H_0\)</span> is true</em>, then the probability of incorrectly rejecting <span class="math inline">\(H_0\)</span> is <span class="math inline">\(\alpha\)</span>.
We have seen that <em>if <span class="math inline">\(H_0\)</span> is false</em>, then the probability of incorrectly failing to reject <span class="math inline">\(H_0\)</span> is <span class="math inline">\(\beta\)</span>. Conversely, the probability of <em>correctly rejecting <span class="math inline">\(H_0\)</span></em> is <span class="math inline">\(1-\beta\)</span>.
This is also known as the <strong>statistical power</strong> of our test.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center"><span class="math inline">\(H_0\)</span> is True</th>
<th align="center"><span class="math inline">\(H_0\)</span> is False</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Test doesn’t reject <span class="math inline">\(H_0\)</span></td>
<td align="center">Correct<br><strong>1-<span class="math inline">\(\alpha\)</span></strong></td>
<td align="center">Type II Error<br>(<span class="math inline">\(\beta\)</span>)</td>
</tr>
<tr class="even">
<td align="left">Test rejects <span class="math inline">\(H_0\)</span></td>
<td align="center">Type I Error<br>(<span class="math inline">\(\alpha\)</span>)</td>
<td align="center">Correct<br><strong>1-<span class="math inline">\(\beta\)</span></strong><br><strong>Power</strong></td>
</tr>
</tbody>
</table>
<div class="def">
<h4 id="statistical-power" class="unnumbered">Statistical power</h4>
<p>Statistical power is the probability of a hypothesis test of finding an effect if there is an effect to be found.</p>
</div>
</div>
<div id="example-2-a-biased-coin" class="section level3 unnumbered">
<h3>Example 2: A biased coin</h3>
<p>I have a trick coin which is weighted so that it lands on heads 60% of the time (rather than the usual 50% for everyday fair coins).
<br>
Oh no! Umberto has noticed that whenever we flip a coin I call heads, and I often seem to win. He accuses me of cheating by using a trick coin!
I make him an offer: he can flip the coin 50 times in order to decide whether or not it really is a trick coin.</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>In Umberto’s 50 coin flips, what proportion of heads would lead him to the correct conclusion that the coin is a trick coin?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-4" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-4&#39;, &#39;sol-start-4&#39;)"></span>
</p>
<div id="sol-body-4" class="solution-body" style="display: none;">
<p>If Umberto flips the coin 50 times, under the null hypothesis, he would need to get a sample statistic (<span class="math inline">\(\hat{p}\)</span>) of .64 or greater</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># Specify our possible outcomes and their probabilities under the null</span></a>
<a class="sourceLine" id="cb10-2" title="2">outcomes &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">vals =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&#39;Heads&#39;</span>, <span class="st">&#39;Tails&#39;</span>)))</a>
<a class="sourceLine" id="cb10-3" title="3">prob &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-4" title="4"></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co"># generate samples under the null</span></a>
<a class="sourceLine" id="cb10-6" title="6">samples &lt;-<span class="st"> </span><span class="kw">rep_sample_n</span>(outcomes, <span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">prob =</span> prob)</a>
<a class="sourceLine" id="cb10-7" title="7"></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co"># calculate the statistics for each sample to create the null distribution</span></a>
<a class="sourceLine" id="cb10-9" title="9">null_distribution &lt;-<span class="st"> </span>samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">prop =</span> <span class="kw">sum</span>(vals <span class="op">==</span><span class="st"> &#39;Heads&#39;</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb10-12" title="12"></a>
<a class="sourceLine" id="cb10-13" title="13">null_distribution &lt;-<span class="st"> </span>null_distribution <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="st">  </span><span class="kw">arrange</span>(prop) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">idx =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb10-16" title="16"></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co"># plot the null distribution</span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="kw">ggplot</span>(null_distribution, <span class="kw">aes</span>(<span class="dt">x =</span> prop, <span class="dt">fill =</span> (idx <span class="op">&gt;=</span><span class="st"> </span><span class="dv">950</span>))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-19" title="19"><span class="st">  </span><span class="kw">geom_dotplot</span>(<span class="dt">binwidth =</span> <span class="fl">0.01</span>, <span class="dt">dotsize =</span> <span class="fl">0.5</span>, <span class="dt">stackratio =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-20" title="20"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&#39;white&#39;</span>, <span class="st">&#39;tomato1&#39;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-21" title="21"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expr</span>(<span class="kw">hat</span>(p)))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">null_distribution <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">  </span><span class="kw">filter</span>(idx <span class="op">==</span><span class="st"> </span><span class="dv">950</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   replicate  prop   idx
##       &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
## 1        92  0.62   950</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Things we know so far:</p>
<ul>
<li>The coin is rigged to land on heads on 60% of flips - the true probability of heads is 0.6.</li>
<li>If 62% or more of Umberto’s 50 coin flips come up heads, then he will reject his null hypothesis (that the coin is fair)</li>
</ul>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>What’s the probability that Umberto’s 50 flips will come up with 64% or more heads?
<br>
In other words, what is the power of his test?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-5" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-5&#39;, &#39;sol-start-5&#39;)"></span>
</p>
<div id="sol-body-5" class="solution-body" style="display: none;">
<p>We can actually generate the true sampling distribution because we know the true parameter (i.e., we know that the coin lands on heads 60% of the time).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">outcomes &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">vals =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&#39;Heads&#39;</span>, <span class="st">&#39;Tails&#39;</span>)))</a>
<a class="sourceLine" id="cb13-2" title="2">prob &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>)</a>
<a class="sourceLine" id="cb13-3" title="3"></a>
<a class="sourceLine" id="cb13-4" title="4">samples &lt;-<span class="st"> </span><span class="kw">rep_sample_n</span>(outcomes, <span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">prob =</span> prob)</a>
<a class="sourceLine" id="cb13-5" title="5"></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co"># calculate the statistics for each sample to create the null distribution</span></a>
<a class="sourceLine" id="cb13-7" title="7">alternative_distribution &lt;-<span class="st"> </span>samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">prop =</span> <span class="kw">sum</span>(vals <span class="op">==</span><span class="st"> &#39;Heads&#39;</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb13-10" title="10"></a>
<a class="sourceLine" id="cb13-11" title="11">alternative_distribution <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb13-13" title="13">    <span class="dt">prob_crit =</span> <span class="kw">sum</span>(prop <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.62</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>()</a>
<a class="sourceLine" id="cb13-14" title="14">  )</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   prob_crit
##       &lt;dbl&gt;
## 1     0.463</code></pre>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="generalising-it" class="section level3 unnumbered">
<h3>Generalising it</h3>
<ol style="list-style-type: decimal">
<li>When we conduct NHST, we set <span class="math inline">\(\alpha\)</span>.<br />
</li>
<li>In setting <span class="math inline">\(\alpha\)</span>, we define a <strong>critical region</strong> under the null distribution. The <strong>critical value</strong> is the value of the statistic which defines the start of this region. Any statistic more extreme than this will result in rejecting the null hypothesis.</li>
<li>If the null hypothesis is false, the probability that we reject the null hypothesis depends on a) how far away from the null hypothesis the true state of the world is, and b) our sample size.</li>
<li>For a given <strong>effect size</strong> (i.e., difference from the null hypothesis), we can compute the power of a test based on a given sample size. This corresponds to the probability of getting a statistic more extreme than the critical value, given a theorised effect size (i.e., a theorised alternative distribution)</li>
</ol>
</div>
<div id="overlapping-distributions" class="section level3 unnumbered">
<h3>Overlapping distributions</h3>
<p>Talk through applet</p>
<p><a href="https://istats.shinyapps.io/power/" class="uri">https://istats.shinyapps.io/power/</a>
<a href="https://rpsychologist.com/d3/NHST/" class="uri">https://rpsychologist.com/d3/NHST/</a></p>
</div>
<div id="in-class-activity" class="section level3">
<h3><span class="header-section-number">1.2.1</span> In-class activity</h3>
<hr />
</div>
</div>
<div id="lab" class="section level2">
<h2><span class="header-section-number">1.3</span> Lab</h2>
<p>Q1 - if my trick coin was actually weighted so that it landed on heads 75% of the time, what would the power of Umberto’s test be?</p>
<div class="red">
<p>For a given <strong>effect size</strong> (i.e., difference from the null hypothesis), we can compute the power of a test based on a given sample size.
However….
we can also decide on what we want the power of a test to be, and ask what the minimum sample size is that is needed to detect a given effect size.</p>
</div>
<p>Q2.- how many coin flips should Umberto do in order to increase his power to 80%?
A haven’t thought about this yet :)</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap-normal.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
>>>>>>> Stashed changes
